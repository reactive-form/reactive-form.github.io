/*!
 * rcfm 0.2.2 | Model iife | https://jilinxiangyun.com
 * Copyright 2021 JLxiangyun | MIT license
 */
var ReactiveForm=(()=>{var nt=Object.defineProperty,no=Object.defineProperties;var so=Object.getOwnPropertyDescriptors;var qt=Object.getOwnPropertySymbols;var po=Object.prototype.hasOwnProperty,uo=Object.prototype.propertyIsEnumerable;var st=(e,t,r)=>t in e?nt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,u=(e,t)=>{for(var r in t||(t={}))po.call(t,r)&&st(e,r,t[r]);if(qt)for(var r of qt(t))uo.call(t,r)&&st(e,r,t[r]);return e},x=(e,t)=>no(e,so(t)),fo=e=>nt(e,"__esModule",{value:!0});var co=(e,t)=>{fo(e);for(var r in t)nt(e,r,{get:t[r],enumerable:!0})};var N=(e,t,r)=>(st(e,typeof t!="symbol"?t+"":t,r),r);var zo={};co(zo,{Calculator:()=>k,Context:()=>R,Exception:()=>D,Form:()=>L,I18n:()=>w,Reactive:()=>A,Schema:()=>rt,Struct:()=>ze,Type:()=>_,Validator:()=>I,guid:()=>P});var D=class extends Error{constructor(t={}){typeof t=="string"&&(t={type:t});let{type:r,message:o}=t;super(o);this.type=this.name=r}static create(...t){return new D(...t)}static raise(...t){throw new D(...t)}},E=D.raise;var mo=0;function P(){return`${Date.now()}${mo+=1}`}var _={ANY_TYPE:"*",SPECIFIC_TYPES:["String","Number","Boolean","Array","Object","RegExp","Function","Null","Undefined","Map","WeakMap","Symbol","File","Blob","Promise"],exceptions:{INVALID_DATA_TYPE:"TYPE_INVALID_DATA_TYPE"},get(e){let t=/\[object\s+(.*)\]/;return Object.prototype.toString.call(e).match(t)[1]},within(e={}){let{type:t,types:r}=e;return!Array.isArray(t)&&(t=[t]),!Array.isArray(r)&&(r=[r]),t.includes(_.ANY_TYPE)||r.includes(_.ANY_TYPE)?!0:!t.some(o=>!r.includes(o))},mustWithin(e={}){!_.within(e)&&E({type:_.exceptions.INVALID_DATA_TYPE,message:`Data type ${e.type} isn't within ${e.types}`})}},m=_.is={null(e){return _.get(e)==="Null"},undefined(e){return _.get(e)==="Undefined"},number(e){return _.get(e)==="Number"},integer(e){return Number.isInteger(e)},string(e){return _.get(e)==="String"},boolean(e){return _.get(e)==="Boolean"},array(e){return Array.isArray(e)},object(e){return _.get(e)==="Object"},regexp(e){return _.get(e)==="RegExp"},function(e){return _.get(e)==="Function"},positiveInteger(e){return m.integer(e)&&e>0},negativeInteger(e){return m.integer(e)&&e<0},blankArray(e){return m.array(e)&&e.length===0},blankString(e){return m.string(e)&&!!e.match(/^\s*$/)},blankObject(e){return m.object(e)&&Object.keys(e).length===0},nonblankArray(e){return m.array(e)&&e.length>0},nonblankString(e){return m.string(e)&&!!e.match(/\S/)},nonblankObject(e){return m.object(e)&&Object.keys(e).length>0},typeString(e){return e===_.ANY_TYPE?!0:_.SPECIFIC_TYPES.includes(e)},typeArray(e){return m.nonblankArray(e)?e.every(t=>t===_.ANY_TYPE?!0:_.within({type:t,types:_.SPECIFIC_TYPES})):!1},type(e){return m.typeString(e)||m.typeArray(e)},blank(e){return[null,void 0,NaN].includes(e)||m.blankString(e)||m.blankArray(e)||m.blankObject(e)?!0:m.array(e)?!e.some(t=>!m.blank(t)):!1}},b=_.isnt=(()=>{let e={};return Object.keys(m).forEach(t=>{e[t]=function(r){return!m[t](r)}}),e})(),h=_.mustbe=(()=>{let e={};return Object.keys(b).forEach(t=>{e[t]=function(r,o="The argument"){let i=m.object(o)?o.message:"";b[t](r)&&E({type:_.exceptions.INVALID_DATA_TYPE,message:i||`${o} must be '${t.toUpperCase()}'`})}}),e})(),pt=_.musntbe=(()=>{let e={};return Object.keys(m).forEach(t=>{e[t]=function(r,o="The argument"){let i=m.object(o)?o.message:"";m[t](r)&&E({type:_.exceptions.INVALID_DATA_TYPE,message:i||`${o} must not be '${t.toUpperCase()}'`})}}),e})();var ze={},X=ze.array={unique(e=[]){return e.filter((t,r)=>e.indexOf(t)===r)}},Y=ze.object={from(e=[]){h.array(e);let t={};return e.forEach(r=>t[r[0]]=r[1]),t},collect(e={},t=[]){h.object(e),h.array(t);let r={};return Object.keys(e).forEach(o=>{t.includes(o)&&(r[o]=e[o])}),r},exclude(e={},t=[]){h.object(e),h.array(t);let r={};return Object.keys(e).forEach(o=>{!t.includes(o)&&(r[o]=e[o])}),r}};var Gt={name:"add",argumentSize:[2,1/0],argumentType:"Number",calculate(...e){return e.reduce((t,r)=>t+r)}};var zt={name:"devide",argumentSize:[2,1/0],argumentType:"Number",calculate(...e){return e.reduce((t,r)=>t/r)}};var Wt={name:"map",argumentSize:1,argumentType:"*",calculate(e){return e}};var Xt={name:"minus",argumentSize:[2,1/0],argumentType:"Number",calculate(...e){return e.reduce((t,r)=>t-r)}};var Jt={name:"multiple",argumentSize:[2,1/0],argumentType:"Number",calculate(...e){return e.reduce((t,r)=>t*r)}};var Zt=[Gt,Xt,Jt,zt,Wt];function le(e={},t={}){return e._calculator||(e._calculator=u({},t))}var ut=class{constructor(){le(this,{installed:{}}),Zt.forEach(t=>this.install(t))}static create(...t){return new ut(...t)}},k=ut;N(k,"exceptions",{CONFLICTED_NAME:"CALCULATOR_CONFLICTED_NAME",UNSUPPORTED_CALCULATION:"CALCULATOR_UNSUPPORTED_CALCULATION",INVALID_ARGUMENT_SIZE:"CALCULATOR_INVALID_ARGUMENT_SIZE",INVALID_ARGUMENT_TYPE:"CALCULATOR_INVALID_ARGUMENT_TYPE"});function Re(e={}){let t=Object.keys(e)[0],r=e[t];return b.array(r)&&(r=[r]),{name:t,args:r}}function ft(e,t){return e.length>=t.min}function ct(e=[],t){return!e.some((r,o)=>{let i=t;return b.type(i)&&(i=i[o]||i[i.length-1]),!_.within({type:_.get(r),types:i})})}k.prototype.mustbeSupported=function(e={}){h.object(e,"Calculation struct");let{name:t}=Re(e),{installed:r}=le(this);!r[t]&&E({type:k.exceptions.UNSUPPORTED_CALCULATION,message:`Unsupported calculator "${t}".`})};k.prototype.isSupported=function(e={}){try{this.mustbeSupported(e)}catch(t){return!1}return!0};k.prototype.isntSupported=function(e={}){return!this.isSupported(e)};k.prototype.calculate=function(e={}){if(this.isntSupported(e))return null;let{installed:t}=le(this),{name:r,args:o}=Re(e),{argumentType:i,argumentSize:l,calculate:a}=t[r];return!ft(o,l)||(o=o.slice(0,l.max).map(n=>this.isSupported(n)?this.calculate(n):n),!ct(o,i))?null:a(...o)};function mt(e){return e===1/0?!1:m.positiveInteger(e)?!0:!m.nonblankArray(e)||e.length!==2||!m.positiveInteger(e[0])?!1:e[1]===1/0?!0:e[1]>e[0]}function dt(e){return m.type(e)?!0:b.nonblankArray(e)?!1:e.every(t=>m.typeArray(t))}function ht(e){return{min:m.integer(e)?e:e[0],max:m.integer(e)?e:e[1]}}k.prototype.install=function(e={}){h.object(e,"Calculator installer");let{name:t,argumentSize:r,argumentType:o,calculate:i}=e;h.nonblankString(t,'Calculator installer "name"'),h.function(i,'Calculator installer "calculate"'),!mt(r)&&E({type:k.exceptions.INVALID_ARGUMENT_SIZE,message:'Invalid calculator installer "argumentSize".'}),!dt(o)&&E({type:k.exceptions.INVALID_ARGUMENT_TYPE,message:'Invalid calculator installer "argumentType".'});let{installed:l}=le(this);t in l&&E({type:k.exceptions.CONFLICTED_NAME,message:`Conflicted calculator name "${t}".`}),l[t]=x(u({},e),{name:t,argumentType:o,calculate:i,argumentSize:ht(r)})};k.prototype.uninstall=function(e=""){let{installed:t}=le(this);e in t&&delete t[e]};function V(e={},t={}){return e._family||(e._family=u({},t))}var _e=class{constructor(){let t=P();V(this,{rootId:t,members:{[t]:{id:t,parentId:null,order:0}}})}static create(...t){return new _e(...t)}static isFamily(t){return t instanceof _e}static isntFamily(t){return!_e.isFamily(t)}static mustbeFamily(t,r=""){_e.isntFamily(t)&&E({type:_e.exceptions.INVALID_INSTANCE,message:r||"Invalid family instance."})}},O=_e;N(O,"exceptions",{MEMBER_NOT_EXIST:"FAMILY_MEMBER_NOT_EXIST",CONFLICTED_PARENT:"FAMILY_MEMBER_CONFLICTED_PARENT",SELF_REFERENCE:"FAMILY_MEMBER_SELF_REFERENCE",INVALID_INSTANCE:"FAMILY_INVALID_INSTANCE"});function Qt(e={},t=[]){t=t.sort((o,i)=>"order"in o?"order"in i?o.order-i.order:-1:1);let r=t.find(o=>"expectedOrder"in o);if(r){let[o,i]=[t.indexOf(r),r.expectedOrder];t.splice(o,1),i<0?t.unshift(r):i>t.length-1?t.push(r):t.splice(i,0,r)}return t.forEach((o,i)=>{delete e[o.id].expectedOrder,e[o.id].order=i}),t}O.prototype.descendant=function(e={},t={}){let{rootId:r,members:o}=V(this),i=e.id||r,l="deep"in t?t.deep:!1,a="self"in t?t.self:!1,n="sort"in t?t.sort:!0;if(!o[i])return null;let[s,p]=[[u({},o[i])],-1];for(;++p<s.length;){let[d,f]=[s[p],[]];if(Object.values(o).forEach(g=>{g.id!==r&&g.parentId===d.id&&f.push(u({},g))}),f.length&&(n&&(f=Qt(o,f)),s=s.concat(f)),!l)break}return a||s.shift(),s.length?s:null};O.prototype.add=function(e={}){let{rootId:t,members:r}=V(this),o=e.id||P(),i=(e.parent?e.parent.id:e.parentId)||t,l=e.order||1/0;if(h.nonblankString(o,'Family member "id"'),h.nonblankString(i,'Family member "parentId"'),h.number(l,'Family member "order"'),o===i&&E({type:O.exceptions.SELF_REFERENCE,message:"Any family member's parent cannot be itself."}),!r[i]&&E({type:O.exceptions.MEMBER_NOT_EXIST,message:`Family member ${i} is not existed.`}),r[o]){if(r[o].parentId===i)return u({},r[o]);E({type:O.exceptions.CONFLICTED_PARENT,message:"Any family member's parent cannot be changed."})}return r[o]={id:o,parentId:i,expectedOrder:l,touchedAt:P()},this.descendant({id:i},{sort:!0}),u({},r[o])};O.prototype.ancestor=function(e={},t={}){let{id:r}=e,{members:o}=V(this),i="deep"in t?t.deep:!1,l="self"in t?t.self:!1;if(!o[r])return null;let[a,n]=[[u({},o[r])],-1];for(;++n<a.length;){let s=o[a[n].parentId];if(s&&a.push(u({},s)),!i)break}return i?(l||a.shift(),a.length?a:null):(a.shift(),a[0]?a[0]:null)};O.prototype.delete=function(e={}){let{members:t,rootId:r}=V(this);if(e.id===r)return;let o=t[e.id];if(!o)return;let{parentId:i}=o;this.descendant({id:e.id},{self:!0,deep:!0,sort:!1}).forEach(({id:l})=>delete t[l]),this.descendant({id:i},{sort:!0})};O.prototype.has=function(e={}){let{members:t}=V(this);return e.id in t};O.prototype.hasnt=function(e={}){return!this.has(e)};O.prototype.reorder=function(e={}){let{id:t,order:r}=e,{rootId:o,members:i}=V(this);h.number(r,'Family member "order"'),!(!i[t]||t===o)&&r!==i[t].order&&(i[t].expectedOrder=r,i[t].touchedAt=P(),this.descendant({id:i[t].parentId},{sort:!0}))};O.prototype.root=function(){let{rootId:e,members:t}=V(this);return u({},t[e])};O.prototype.sibling=function(e={},t={}){let{id:r}=e,{members:o,rootId:i}=V(this),l="self"in t?t.self:!1;if(!o[r])return null;if(r===i)return l?[this.root()]:null;let a=this.ancestor({id:r});if(!a)return null;let n=this.descendant(a);return l?n:(n=n.filter(s=>s.id!==r),n.length?n:null)};function U(e={},t={}){return e._dependency||(e._dependency=u({},t))}var Ie=class{constructor(){U(this,{associations:{},group:{reliers:{}},cache:{reliers:{}}})}static create(...t){return new Ie(...t)}static isDependency(t){return t instanceof Ie}static isntDependency(t){return!Ie.isDependency(t)}static mustbeDependency(t,r=""){Ie.isntDependency(t)&&E({type:Ie.exceptions.INVALID_INSTANCE,message:r||"Invalid dependency instance."})}},ee=Ie;N(ee,"exceptions",{CIRCLE_REFERENCE:"DEPENDENCY_CIRCLE_REFERENCE",INVALID_INSTANCE:"DEPENDENCY_INVALID_INSTANCE"});var er="#",We="_";function re(e={}){let{id:t,prop:r}=e;return t?`${t}${er}${r||""}`:We}function ae(e=""){if(e===We)return{id:"",prop:""};let[t,r]=e.split(er);return{id:t,prop:r}}function ge(e={},t){if(!t)return Object.keys(e).forEach(l=>delete e[l]);let{id:r,prop:o}=t;if(!r)return delete e[We];let i=re({id:r,prop:o});o?(delete e[i],delete e[re({id:r})],Object.keys(e).forEach(l=>{e[l].includes(i)&&delete e[l]})):Object.keys(e).forEach(l=>{(ae(l).id===r||e[l].includes(i))&&delete e[l]})}var ve="__GLOBAL__";ee.prototype.add=function(e=[],t={}){let r="group"in t?t.group:ve;h.nonblankString(r,'Association "group"'),b.array(e)&&(e=[e]),e=e.map(({provider:l,relier:a})=>{h.nonblankString(a.id,'Association "relier.id"'),h.nonblankString(l.id,'Association "provider.id"'),h.nonblankString(a.prop,'Association "relier.prop"'),h.nonblankString(l.prop,'Association "provider.prop"');let n={provider:re(l),relier:re(a)};return{provider:l,relier:a,path:n}});let{error:o,rollbackQueue:i}=ho(this,e);if(!o)return yo(this,e,r);throw bo(this,i),o};function ho(e,t){let r=[],{associations:o}=U(e),i=U(e).cache.reliers;return t.some(({provider:a,relier:n,path:s})=>{if(s.provider===s.relier)return!0;let p=e.reliers(n,{split:!1});return p&&p.includes(s.provider)?!0:(o[s.provider]||(o[s.provider]=[]),o[s.provider].includes(s.relier)||(o[s.provider].push(s.relier),r.push({provider:a,relier:n,path:s}),ge(i,a)),!1)})?{rollbackQueue:r,error:D.create({type:ee.exceptions.CIRCLE_REFERENCE})}:{error:null,rollbackQueue:null}}function bo(e,t){let{associations:r}=U(e),o=U(e).cache.reliers;t.forEach(({provider:i,path:l})=>{let a=r[l.provider].indexOf(l.relier);a<0||(r[l.provider].splice(a,1),!r[l.provider].length&&delete r[l.provider],ge(o,i))})}function yo(e,t,r){let o=U(e).group.reliers;t.forEach(({path:i})=>{let l=o[i.provider]||(o[i.provider]={}),a=l[i.relier]||(l[i.relier]=[]);!a.includes(r)&&a.push(r)})}ee.prototype.delete=function(e={},t={}){let{id:r,prop:o}=e;if(!r)return;let{only:i,group:l}=t,a=re(e),{associations:n}=U(this),s=U(this).cache.reliers,p=U(this).group.reliers,d=o?f=>f===a:f=>ae(f).id===r;i!=="relier"&&(ge(s,e),o?(delete n[a],delete p[a]):Object.keys(n).map(f=>{!d(f)||(delete n[f],delete p[f])})),Object.keys(n).forEach(f=>{let g=n[f].length;n[f]=n[f].filter(T=>{if(!d(T))return!0;if(i!=="relier"||!l||l===ve)return delete p[f][T],!1;let F=p[f][T].findIndex(M=>M===l);return F>=0&&p[f][T].splice(F,1),p[f][T].length?!0:(delete p[f][T],!1)});let C=n[f].length;C!==g&&(ge(s,ae(f)),!C&&delete n[f],!Object.keys(p[f]).length&&delete p[f])})};ee.prototype.reliers=function(e=[],t={}){b.array(e)&&(e=[e]);let r=e.some(S=>b.object(S)||!S.id);r&&(e=[{}]);let o="reload"in t?t.reload:!1,i="split"in t?t.split:!0,l="deep"in t?t.deep:!0,a="self"in t?t.self:!0,n="group"in t?t.group:"",{associations:s}=U(this),p=U(this).cache.reliers,d=U(this).group.reliers,[f,g,C]=[[],[],[]];if(e.forEach(S=>{let W=re(S);if("prop"in S?C.push(W):Object.keys(s).forEach(K=>{ae(K).id===S.id&&C.push(K)}),g.push(S.id),!Eo(s,S))return ge(p,S);(o||!(W in p))&&(p[W]=go(s,S),p[W]=tr(s,p[W])),f=f.concat(p[W])}),!f.length)return null;if(e.length>1&&(f=tr(s,X.unique(f))),r||l&&a&&(!n||n===ve))return i?f.map(S=>ae(S)):f;let[T,F]=[[],C.slice()],M=C.map(S=>s[S]).flat();return f.forEach(S=>{if(!l&&!M.includes(S))return;let W=ae(S);if(!(!a&&g.includes(W.id))){if(n&&n!==ve){let K=Object.keys(d).some(xe=>!F.includes(xe)||!Object.keys(d[xe]).includes(S)?!1:d[xe][S].includes(n));if(F.push(S),!K)return}T.push(i?W:S)}}),T.length?T:null};function Eo(e={},t={}){let{id:r,prop:o}=t;return r?o?re(t)in e:Object.keys(e).filter(i=>ae(i).id===r).length>0:Object.keys(e).length>0}function go(e={},t={}){let{id:r,prop:o}=t,i=(()=>r?o?(e[re(t)]||[]).slice():X.unique(Object.keys(e).filter(a=>ae(a).id===r).map(a=>e[a]).flat()):X.unique(Object.values(e).flat()))(),l=-1;for(;++l<i.length;)(e[i[l]]||[]).forEach(n=>!i.includes(n)&&i.push(n));return i}function tr(e={},t=[]){let r=-1;for(;++r<t.length;)(e[t[r]]||[]).forEach(i=>{let l=t.indexOf(i);l>r||(t.splice(l,1),t.push(i),r--)});return t}function ne(e={},t={}){return e._dispatcher||(e._dispatcher=u({},t))}var $=class{constructor(t={}){"target"in t&&h.function(t.target,"options.target"),ne(this,{isAborted:!1,listeners:{},target:t.target||function(r){return r}})}static create(...t){return new $(...t)}};$.prototype.abort=function(e=!0){ne(this).isAborted=e===!0};function Ce(e={},t,r){t in e&&(r?r=m.array(r)?r:[r]:r=Object.keys(e[t]),r.forEach(o=>{o in e[t]&&!e[t][o].length&&delete e[t][o]}),!Object.keys(e[t]).length&&delete e[t])}$.prototype.add=function(e={},t){let{id:r,event:o}=e,{listeners:i}=ne(this);h.nonblankString(r,'Dispatcher "id"'),h.nonblankString(o,'Dispatcher "event"'),h.function(t,'Dispatcher "handler"'),i[r]||(i[r]={});let l=i[r][o]||(i[r][o]=[]),a=l.push({callback:t})-1;return function(){l.splice(a,1),Ce(i,r,o)}};$.prototype.delete=function(e={},t){let{id:r,event:o}=e,{listeners:i}=ne(this);if(!!i[r]){if(!o){r in i&&delete i[r];return}if(!!i[r][o]){if(!t){o in i[r]&&delete i[r][o];return}i[r][o]=i[r][o].filter(l=>l.callback!==t),Ce(i,r,o)}}};$.prototype.trigger=function(e={},t){t&&h.function(t,'Dispatcher "handler"');let{id:r,event:o,detail:i}=e,{listeners:l,target:a,isAborted:n}=ne(this);if(n||!l[r]||!l[r][o])return!1;let s=!1,p={type:o,target:a(r),detail:i};return t?t(p,i)===!1:(l[r][o].forEach(({callback:d})=>{let f=d(p,i)===!1;s||(s=f)}),!s)};function Ne(e={},t={}){return e._executor||(e._executor=u({},t))}var se=class{constructor(t={}){h.function(t.runner,"options.runner"),Ne(this,{isAborted:!1,queues:{current:[],next:[]},runner:t.runner||function(r){return r}})}static create(...t){return new se(...t)}};se.prototype.abort=function(e=!0){Ne(this).isAborted=e===!0};se.prototype.run=function(e){let{queues:t,runner:r,isAborted:o}=Ne(this);arguments.length&&(b.array(e)&&(e=[e]),t.next=t.next.concat(e)),!o&&(t.current.length||!t.next.length||(t.current=t.next,t.next=[],r(t.current.slice()),t.current=[],this.run()))};function pe(e={},t={}){return e._hook||(e._hook=u({},t))}var q=class{constructor(){pe(this,{isAborted:!1,hooks:{}})}static create(...t){return new q(...t)}};q.prototype.abort=function(e=!0){pe(this).isAborted=e===!0};q.prototype.add=function(e="",t){h.nonblankString(e,'Hook "type"'),h.function(t,'Hook "handler"');let{hooks:r}=pe(this);return r[e]||(r[e]=[]),r[e].push(t),function(){let o=r[e].indexOf(t);o>=0&&r[e].splice(o,1)}};q.prototype.delete=function(e="",t){let{hooks:r}=pe(this);!r[e]||(t?r[e]=r[e].filter(o=>o!==t):r[e]=[])};q.prototype.run=function(e="",t={}){let{hooks:r,isAborted:o}=pe(this);if(o)return!1;if(!r[e])return!0;let[i,l]=[t.arguments,!1];return b.array(i)&&(i=[i]),r[e].forEach(a=>{let n=a(...i);l||(l=n===!1)}),o?!1:!l};function bt(e={},t={}){let{members:r,family:o,dependency:i,hooks:l}=t,a="id"in e?e.id:e.id=P(),n=o.root().id,s=a===n;if(s&&r[a])return{};let p=s?null:(()=>"parentId"in e?e.parentId:e.parentId=n)();if(!s&&o.has({id:a}))return{};if(!s&&o.hasnt({id:p}))return{};let d="props"in e?e.props:e.props={};"children"in d||(d.children=[]),"order"in d||(d.order=1/0);let f={mutations:{set:[]},mutated:[]};return l.run("before-add",{arguments:[e,"before-add"]})?(!s&&o.add({id:a,parentId:p}),r[a]={},f.mutated=[{id:a}],Object.keys(e.props).forEach(g=>{f.mutations.set.push({id:a,prop:g,value:d[g]})}),!s&&i.add({provider:{id:a,prop:"order"},relier:{id:p,prop:"children"}}),l.run("after-add",{arguments:[e,f,"after-add"]}),f):{}}var Xe="__raw__prop__",Je="__raw__error__",Ze="__prop__",Qe="__error__";function ue(e,t={}){return(t.raw?Xe:Ze)+e}function fe(e,t={}){return(t.raw?Je:Qe)+e}function yt(e={},t={}){let{members:r,family:o,hooks:i}=t,{id:l,prop:a}=e;if(o.hasnt({id:l}))return{};let n={mutated:[]},s={raw:ue(a,{raw:!0}),calc:ue(a)},p={raw:fe(a,{raw:!0}),calc:fe(a)};if(!i.run("before-calc",{arguments:[e,"before-calc"]}))return{};if(a==="children"){let d=o.descendant({id:l})||[];return r[l][s.calc]=d.map(({id:f})=>({id:f})),r[l][p.calc]=r[l][p.raw],n.mutated.push({id:l}),i.run("after-calc",{arguments:[e,n,"after-calc"]}),n}return r[l][s.calc]=r[l][s.raw],r[l][p.calc]=r[l][p.raw],n.mutated.push({id:l}),i.run("after-calc",{arguments:[e,n,"after-calc"]}),n}function Et(e={},t={}){let{id:r}=e,{members:o,family:i,dependency:l,hooks:a}=t;if(i.hasnt({id:r}))return{};if(r===i.root().id)return{};if(!a.run("before-del",{arguments:[e,"before-del"]}))return{};let n={mutations:{set:[],calc:[]},mutated:[]},s=i.ancestor({id:r}),p=i.descendant({id:r},{deep:!0,self:!0}),d=l.reliers(p,{self:!1});return p.forEach(({id:f})=>{delete o[f],i.delete({id:f}),l.delete({id:f}),n.mutated.push({id:f})}),d&&(n.mutations.calc=d),s&&(i.descendant({id:s.id})||[]).forEach((f,g)=>{n.mutations.set.push({id:f.id,prop:"order",value:g})}),a.run("after-del",{arguments:[e,n,"after-del"]}),n}function gt(e={},t={}){let{members:r,family:o,dependency:i,hooks:l}=t,{id:a,prop:n,value:s}=e;if(o.hasnt({id:a}))return{};let p={raw:ue(n,{raw:!0})},d={raw:fe(n,{raw:!0})};if(Object.is(r[a][p.raw],s))return{};let f={mutations:{calc:[]},mutated:[]};if(n==="order"){let C=o.ancestor({id:a});return C?l.run("before-set",{arguments:[e,"before-set"]})?(o.reorder({id:a,order:e.value}),o.descendant(C).forEach(({id:T,order:F})=>{r[T][p.raw]=F,r[T][d.raw]=null,f.mutated.push({id:T}),f.mutations.calc.push({id:T,prop:n});let M=i.reliers({id:T,prop:n})||[];f.mutations.calc=f.mutations.calc.concat(M)}),l.run("after-set",{arguments:[e,f,"after-set"]}),f):{}:{}}if(!l.run("before-set",{arguments:[e,"before-set"]}))return{};r[a][p.raw]=e.value,r[a][d.raw]=null,f.mutated=[{id:a}];let g=i.reliers({id:a,prop:n})||[];return f.mutations.calc=[{id:a,prop:n}].concat(g),l.run("after-set",{arguments:[e,f,"after-set"]}),f}function Ao(e=[],t=[]){let[r,o]=[{},{}];return t.forEach(i=>{o[i]=[],r[i]=[]}),e.forEach(i=>{let{id:l,action:a}=i;!t.includes(a)||(o[a].push(l),r[a].push(i))}),{jobs:r,ids:o}}function Fe(e={},t,r=[]){t||(t={}),t.mutated&&(e.mutated=e.mutated.concat(t.mutated)),r.forEach(o=>{e.mutations[o]||(e.mutations[o]=[]),t.mutations&&t.mutations[o]&&(e.mutations[o]=e.mutations[o].concat(t.mutations[o]))})}function rr(e=[]){return e.filter((t,r,o)=>o.findIndex(l=>l.id===t.id&&l.prop===t.prop)===r)}function At(e=[],t={}){let{dispatcher:r}=t,o=["del","add","set","calc"],{jobs:i,ids:l}=Ao(e,o),a={mutated:[],mutations:{}};Fe(a,{},o),i.del.forEach(n=>{Fe(a,Et(n,t),["add","set","calc"])}),i.add=a.mutations.add.concat(i.add),i.add.forEach(n=>{let{id:s,parentId:p}=n;l.del.includes(s)||l.del.includes(p)||Fe(a,bt(n,t),["set","calc"])}),i.set=a.mutations.set.concat(i.set),i.set=rr(i.set.reverse()).reverse(),i.set.forEach(n=>{l.del.includes(n.id)||Fe(a,gt(n,t),["calc"])}),i.calc=a.mutations.calc.concat(i.calc),i.calc=rr(i.calc.reverse()).reverse(),i.calc.forEach(n=>{l.del.includes(n.id)||Fe(a,yt(n,t),[])}),X.unique(a.mutated.map(n=>n.id)).forEach(n=>{r.trigger({id:n,event:"after-mutation"})})}var xt=class{constructor(){this.members={},this.family=O.create(),this.dependency=ee.create(),this.dispatcher=$.create(),this.hooks=q.create(),this.executor=se.create({runner:t=>At(t,this)}),this.executor.run({action:"add",id:this.family.root().id})}static create(...t){return new xt(...t)}},R=xt;N(R,"Family",O),N(R,"Dependency",ee),N(R,"Executor",se),N(R,"Dispatcher",$),N(R,"Hook",q);R.prototype.add=function(e){let t=b.array(e);t&&(e=[e||{}]);let r=e.map(o=>x(u({},o),{id:P(),action:"add"}));return this.executor.run(r),t?r[0].id:r.map(o=>o.id)};R.prototype.delete=function(e){if(!e){this.executor.abort(),this.dispatcher.abort(),this.hook.abort();for(let r in this)delete this[r];return}b.array(e)&&(e=[e]);let t=e.map(r=>x(u({},r),{action:"del"}));this.executor.run(t)};R.prototype.find=function(e){return b.function(e)?null:Object.keys(this.members).find(t=>e({id:t}))};R.prototype.get=function(e={},t={}){let{members:r}=this,o="include"in t?t.include:[],i=o.includes("error"),l=o.includes("raw");return"prop"in e?xo(r,e,i,l):_o(r,e,i,l)};function xo(e,t,r,o){let{id:i,prop:l}=t;if(!e[i])return null;let[a,n,s,p]=[null,null,null,null],d=ue(l);if(a=d in e[i]?e[i][d]:null,r){let f=fe(l);n=e[i][f]||null}if(o){let f=ue(l,{raw:!0});if(s=f in e[i]?e[i][f]:null,r){let g=fe(l,{raw:!0});p=e[i][g]||null}}return!r&&!o?a:r&&!o?{value:a,error:n}:r?{value:a,error:n,raw:{value:s,error:p}}:{value:a,raw:{value:s}}}function _o(e,t,r,o){let{id:i}=t,[l,a,n,s]=[{},null,{},null];return e[i]?(Object.keys(e[i]).forEach(p=>{let d=e[i][p];if(p.startsWith(Ze))return l[p.replace(Ze,"")]=d;if(d&&r&&p.startsWith(Qe))return a||(a={}),a[p.replace(Qe,"")]=d;if(o&&p.startsWith(Xe))return n[p.replace(Xe,"")]=d;if(d&&o&&r&&p.startsWith(Je))return s||(s={}),s[p.replace(Je,"")]=d}),!o&&!r?l:r&&!o?{values:l,errors:a}:r?{values:l,errors:a,raw:{values:n,errors:s}}:{values:l,raw:{values:n}}):null}R.prototype.naming=function(e=""){return{prop:ue(e),error:fe(e),raw:{prop:ue(e,{raw:!0}),error:fe(e,{raw:!0})}}};R.prototype.set=function(e){if(!e)return;b.array(e)&&(e=[e]);let t=e.map(r=>x(u({},r),{action:"set"}));this.executor.run(t)};R.prototype.subscribe=function(e={},t){let r={id:e.id,event:"after-mutation"},o="immediately"in e?e.immediately:!0,i=this.dispatcher.add(r,t);return o&&this.dispatcher.trigger(r,t),i};var Ae={type:"Fieldset"};function Pe(e,t={}){let r=e._storeOfSchema||(e._storeOfSchema={});return t===void 0?e._storeOfSchema:(Object.assign(r,Y.collect(t,["parseExpression","parseReference"])),r)}var et="when",Le="then",ke="else",De="and",Ve="or",we="not";function Te(e){return b.object(e)?!1:et in e&&Le in e}function Se(e){return b.object(e)?!1:ke in e}function ye(e){return Te(e)||Se(e)}function tt(e){return b.array(e)?!1:!e.some(t=>!ye(t))}var Me=class{static isConditionObject(t){return ye(t)}static isConditionArray(t){return tt(t)}static isCondition(t){return ye(t)||tt(t)}static isntCondition(t){return!Me.isCondition(t)}static mustbeCondition(t,r=""){Me.isCondition(t)||E({type:Me.exceptions.INVALID_CONDITION,message:r||"Invalid condition statement."})}},ce=Me;N(ce,"exceptions",{INVALID_CONDITION:"INVALID_CONDITION"});function _t(e={},t){let[r,o,i]=["unknown",e[et],-1];for(b.array(o)&&(o=[o]);++i<o.length;){let[l,a]=[o[i],[]];if(m.object(l)&&De in l){if(i>0&&r!==!0)break;l=l[De],a.push(De)}else if(m.object(l)&&Ve in l){if(i>0&&r===!0)break;l=l[Ve],a.push(Ve)}m.object(l)&&we in l&&(l=l[we],a.push(we));let n=t(l);if(b.boolean(n)&&(n="unknown"),a.includes(we)&&m.boolean(n)&&(n=!n),a.includes(De)){if(r=n,r!==!0)break}else if(a.includes(Ve)){if(r!==!0&&(r=n),r===!0)break}else r=n}return{truthy:r,result:e[Le]}}function It(e={}){return{result:e[ke]}}function Io(e){if(m.boolean(e))return e}ce.parse=function(e,t){ce.mustbeCondition(e),t===void 0&&(t=Io),h.function(t,'Condition "parseExpression"'),ye(e)&&(e=[e]);let r;return e.some(o=>{if(Te(o)){let{truthy:i,result:l}=_t(o,t);if(i===!0)return r=l,!0}else if(Se(o)){let{result:i}=It(o);return r=i,!0}return!1}),r};ce.possibilities=function(e){ce.mustbeCondition(e),ye(e)&&(e=[e]);let t=!1,r=e.map(o=>{if(Te(o))return o[Le];if(Se(o))return t=!0,o[ke]});return r=X.unique(r),t||!r.includes(void 0)&&r.push(void 0),r};var oe=ce;var Ue=/<<\s*([^(<<)(>>)\s]+)\s*>>/,or=new RegExp(Ue,"g");function je(e="",t={}){let{raw:r,flag:o,strict:i}=t;if(r)return`<< ${e} >>`;let l=`<<\\s*${e}\\s*>>`;return i&&(l=`^${l}$`),new RegExp(l,o)}function vt(e){return b.string(e)?!1:!!e.match(Ue)}var He=class{static isInterpolation(t){return vt(t)}static isntInterpolation(t){return!He.isInterpolation(t)}static mustbeInterpolation(t,r=""){He.isInterpolation(t)||E({type:He.exceptions.INVALID_INTERPOLATION,message:r||"Invalid interpolation statement."})}},G=He;N(G,"exceptions",{INVALID_INTERPOLATION:"INVALID_INTERPOLATION"});function Be(e=""){return e.match(or)}function Nt(e=""){let t=e.match(Ue);return t?t[1]:null}G.references=function(e="",t={}){if(G.isntInterpolation(e))return null;let o=(Be(e)||[]).map(i=>Nt(i));return t.unique!==!1&&(o=X.unique(o)),o.length?o:null};G.parse=function(e="",t={}){G.mustbeInterpolation(e);let r=Be(e),o=G.references(e,{unique:!1}),i=l=>m.function(t)?t(l):t[l];if(r.length===1){let l=je(o[0],{strict:!0});if(e.match(l))return e=i(o[0])}return o.forEach((l,a)=>{e=e.replace(r[a],i(l))}),e};G.replace=function(e="",t={}){return G.mustbeInterpolation(e),Object.keys(t).forEach(r=>{let o=je(t[r],{raw:!0});r=je(r,{flag:"g"}),e=e.replace(r,o)}),e};var me=G;var Tt=class{constructor(t={}){Pe(this,t)}static create(...t){return new Tt(...t)}},J=Tt;N(J,"Condition",oe),N(J,"Interpolation",me);function St(e,t){return m.array(e)?e=e.map(r=>St(r,t)):m.object(e)?e=Y.from(Object.keys(e).map(r=>[r,St(e[r],t)])):me.isInterpolation(e)&&(e=me.parse(e,t)),e}function Ot(e,t,r){if(m.array(e)){let o=oe.isConditionArray(e);e=e.map(i=>Ot(i,t,o))}else m.object(e)&&(e=Y.from(Object.keys(e).map(o=>[o,Ot(e[o],t)])));return oe.isConditionArray(e)?e=oe.parse(e,t):oe.isConditionObject(e)&&!r&&(e=oe.parse(e,t)),e}J.prototype.parse=function(e){let{parseReference:t,parseExpression:r}=Pe(this);return e=St(e,t),e=Ot(e,r),e};J.prototype.possibilities=function(e){let t=null;return oe.isCondition(e)?(t=[],oe.possibilities(e).forEach(r=>{if(!oe.isCondition(r))return t.push(r);t=t.concat(this.possibilities(r))})):m.object(e)?Object.keys(e).forEach(r=>{let o=this.possibilities(e[r]);!o||(t=t?t.concat(o):o)}):m.array(e)&&e.forEach(r=>{let o=this.possibilities(r);!o||(t=t?t.concat(o):o)}),t&&X.unique(t)};J.prototype.references=function(e,t={}){let r=[];if(m.array(e))e.forEach(o=>{let i=this.references(o,t);i&&(r=r.concat(i))});else if(m.object(e))Object.keys(e).forEach(o=>{let i=this.references(e[o],t);i&&(r=r.concat(i))});else if(me.isInterpolation(e)){let o=me.references(e,t);o&&(r=r.concat(o))}return t.unique!==!1&&(r=X.unique(r)),r.length?r:null};J.prototype.replace=function(e,t={}){return m.array(e)?e=e.map(r=>this.replace(r,t)):m.object(e)?e=Y.from(Object.keys(e).map(r=>[r,this.replace(e[r],t)])):me.isInterpolation(e)&&(e=me.replace(e,t)),e};var rt=J;function j(e={},t={}){return e._reactive||(e._reactive=u({},t))}var vo={prop:()=>P(),default:null,schemable:!0,calculable:!0,validation:null},ir=vo;function de(e={},t={}){return e._i18n||(e._i18n=u({},t))}var Oe=class{constructor(){de(this,{locales:{},locale:"en"})}static create(...t){return new Oe(...t)}static isI18n(t){return t instanceof Oe}static isntI18n(t){return!Oe.isI18n(t)}static mustbeI18n(t,r){Oe.isntI18n(t)&&E({type:Oe.exceptions.NOT_AN_INSTANCE,message:r||"Invalid i18n instance."})}},w=Oe;N(w,"exceptions",{NOT_AN_INSTANCE:"I18N_NOT_AN_INSTANCE_OF_I18N",UNSUPPORTED_LOCALE:"I18N_UNSUPPORTED_LOCALE"});var lr=".";function ot(e=""){return e.split(lr).map(t=>t.trim()).filter(t=>t.length)}function ar(e=[]){return e.map(t=>t.trim()).filter(t=>t.length).join(lr)}w.prototype.define=function(e="",t=""){let r=de(this).locales;if(!arguments.length)return JSON.parse(JSON.stringify(r));if(b.object(e))return nr(r,e,t);Object.keys(e).forEach(o=>{if(b.object(e[o]))return nr(r,o,e[o]);let i=Object.keys(e[o]).map(l=>[ar([o,l]),e[o][l]]);this.define(Y.from(i))})};function nr(e={},t="",r=""){h.nonblankString(t,"I18n locale path"),h.string(r,"I18n locale template");let[o,i]=["",ot(t)];for(;o=i.shift();){if(!(o in e))e[o]=i.length?{}:r;else{let l=e[o];i.length?m.string(l)&&(e[o]={_:l}):m.string(l)?e[o]=r:e[o]._=r}e=e[o]}}w.prototype.locale=function(e){if(!e)return de(this).locale;de(this).locale=e};function sr(e="",t="",r=""){let o=new RegExp(`{\\s*${t}\\s*}`,"g");if(m.string(r))return e.replace(o,r);try{r=JSON.stringify(r)}catch(i){r=String(r)}return e.replace(o,r)}w.prototype.translate=function(e="",t={}){let r="default"in t?t.default:"",o="variables"in t?t.variables:null;h.string(r,"Default i18n template"),o&&h.object(o,"I18n variables");let[i,l]=[ot(e),de(this).locales],a=No(l,[de(this).locale].concat(i));return m.null(a)&&(a=r),!a||!o?a:To(a,o)};w.prototype.t=w.prototype.translate;function No(e={},t=""){let r="";return t.every((i,l)=>i in e?(e=e[i],l!==t.length-1||(r=m.string(e)?e:e._),!0):!1)?r:null}function To(e="",t={}){return Object.keys(t).forEach(r=>{e=sr(e,r,t[r])}),e}w.prototype.try=function(e=[],t={}){let r="";return e.some(o=>{if(r=this.translate(o,t),r)return!0}),r};var z=w.global=w.create();var pr={memberIsReferenced:"Member { id } is referenced.",conflictedMemberName:"Member name { name } has been occupied.",memberNameRequired:"Member name cannot be blank.",mustBelongsToValidParent:"{ memberType } members can only be inserted into { acceptedParentTypes } parents.",referenceNotFound:"Cannot find reference { reference } among members."};var ur={memberIsReferenced:"\u6210\u5458{ id }\u6B63\u5728\u88AB\u5F15\u7528\u3002",conflictedMemberName:"\u6210\u5458\u540D\u79F0{ name }\u5DF2\u88AB\u5360\u7528\u3002",memberNameRequired:"\u6210\u5458\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A\u3002",mustBelongsToValidParent:"{ memberType }\u7C7B\u578B\u4E58\u5458\u53EA\u80FD\u4F5C\u4E3A{ acceptedParentTypes }\u7C7B\u578B\u5B50\u7EA7\u3002",referenceNotFound:"\u6210\u5458\u4E2D\u4E0D\u5B58\u5728\u5F15\u7528\u8DEF\u5F84{ reference }"};z.define({en:{reactive:pr},zh:{reactive:ur}});var he=z;var fr=".",be=["children","order","type","name"],Ke="__REACTIVE_SCEHMA_REFERENCE__";function cr(e=""){let t=e.split(fr),r=t.pop();return{names:t,prop:r}}function Ye(e=[],t=""){return(t?e.concat(t):e).join(fr)}function mr(e,t){let[r,o]=[e.schema.references(t),{}];return r?(r.forEach(i=>{let l=e.schema.reference.parse(i),a=m.object(l);if(a&&(a=m.nonblankString(l.id)),a&&(a=m.nonblankString(l.prop)),a)return o[i]=JSON.stringify(l);E({type:e.exceptions.REFERENCED_PROVIDER_NOT_FOUND,message:he.t("reactive.referenceNotFound",{variables:{reference:i}})})}),e.schema.replace(t,o)):t}function dr(e,t){let[r,o]=[e.schema.references(t),{}];return r?(r.forEach(i=>{let l=null;try{l=JSON.parse(i)}catch(s){return}let a=e.schema.reference.stringify(l);if(m.nonblankString(a))return o[i]=a;E({type:e.exceptions.REFERENCED_PROVIDER_NOT_FOUND,message:he.t("reactive.referenceNotFound",{variables:{reference:i}})})}),e.schema.replace(t,o)):t}function hr(e={},t={}){return u(u(u({},ir),t),e)}function br(e={}){return Object.keys(e).forEach(t=>{b.function(e[t])||(e[t]=e[t]())}),e}function Lt(e={}){let{id:t,prop:r}=e,o=this.get({id:t,prop:"type"}),{props:i,fallback:l}=j(this).installed[o].config.schema;if(!r)return i.map(s=>{let p=br(hr(s,l));return be.includes(p.prop)&&(p.schemable=p.calculable=!1),p});let a=i.find(s=>s.prop===r),n=br(hr(a||l,l));return n.prop=r,be.includes(r)&&(n.schemable=n.calculable=!1),n}function kt(e="",t={}){var n,s;let{names:r,prop:o}=cr(e),i=t.under||this.family.root(),[l,a]=[null,i.id];if(!r.length||this.family.hasnt({id:a}))return null;for(;l=r.shift();){if(a=(s=(n=this.family.descendant({id:a}))==null?void 0:n.find(g=>this.get({id:g.id,prop:"name"})===l))==null?void 0:s.id,!a)return null;let p=this.get({id:a,prop:"type"}),f=j(this).installed[p].config.schema.reference.parse;if(f)return e=Ye(r,o),f.call(this,{id:a},e)}return{id:a,prop:o}}function Rt(e={},t={}){let{id:r,prop:o}=e,i=t.under||this.family.root();if(this.family.hasnt({id:r}))return"";let l=this.family.ancestor({id:r},{deep:!0,self:!0}),[a,n]=[l.findIndex(p=>p.id===i.id),[]];if(a<0||(l=l.slice(0,a),!l.length))return"";let s=null;for(;s=l.pop();){n.push(this.get({id:s.id,prop:"name"}));let p=this.get({id:s.id,prop:"type"}),f=j(this).installed[p].config.schema.reference.stringify;if(f){let g=Ye(n);return f.call(this,{id:s.id,reference:g},o)}}return Ye(n,o)}function Ct(e){let t=rt.create({parseReference(r){return e.get(JSON.parse(r))},parseExpression(r={}){return e.validator.mustbeSupported(r),!e.validator.error(r)}});return t.for=Lt.bind(e),t.reference={parse:kt.bind(e),stringify:Rt.bind(e)},t}var yr={validators:{dataType:{invalidValue:"Must be a data type within { rule }."},equalTo:{invalidValue:"Must be equal to { rule }."},isInteger:{invalidValue:"{ value } is not an integer."},maxLength:{invalidRule:'Rule of "maxLength" validator must be a positive integer.',invalidValue:"Maximum length is { rule }."},presence:{invalidValue:"Musn't be blank."},withFormat:{invalidValue:"Must match format { rule }."}}};var Er={validators:{dataType:{invalidValue:"\u6570\u636E\u7C7B\u578B\u5FC5\u987B\u662F{ rule }\u3002"},equalTo:{invalidValue:"\u5FC5\u987B\u7B49\u4E8E{ rule }\u3002"},isInteger:{invalidValue:"{ value }\u4E0D\u662F\u4E00\u4E2A\u6574\u6570\u3002"},maxLength:{invalidRule:"\u6821\u9A8C\u89C4\u5219\u5FC5\u987B\u662F\u4E00\u4E2A\u6B63\u6574\u6570\u3002",invalidValue:"\u957F\u5EA6\u4E0D\u80FD\u8D85\u8FC7{ rule }\u3002"},presence:{invalidValue:"\u4E0D\u80FD\u4E3A\u7A7A\u3002"},withFormat:{invalidValue:"\u5FC5\u987B\u7B26\u5408\u683C\u5F0F{ rule }\u3002"}}};z.define({en:{validator:yr},zh:{validator:Er}});var te=z;var gr={name:"dataType",ruleType:["String","Array"],valueType:"*",validate(e,t){if(!_.within({type:_.get(e),types:t}))return te.t("validator.validators.dataType.invalidValue",{variables:{value:e,rule:t}})}};var Ar={name:"equalTo",ruleType:"*",valueType:"*",validate(e,t){if(e!==t)return te.t("validator.validators.equalTo.invalidValue",{variables:{value:e,rule:t}})}};var xr={name:"isInteger",valueType:"Number",validate(e){if(!m.integer(e))return te.t("validator.validators.isInteger.invalidValue",{variables:{value:e}})}};var _r={name:"maxLength",ruleType:"Number",valueType:["String","Array"],validateRule(e){if(!m.positiveInteger(e))return te.t("validator.validators.maxLength.invalidRule")},validate(e,t){if(e.length>t)return te.t("validator.validators.maxLength.invalidValue",{variables:{value:e,rule:t}})}};var Ir={name:"presence",valueType:"*",validate(e){if(m.blank(e))return te.t("validator.validators.presence.invalidValue",{variables:{value:e}})}};var vr={name:"withFormat",ruleType:"RegExp",valueType:"String",validate(e,t){if(!e.match(t))return te.t("validator.validators.withFormat.invalidValue",{variables:{value:e,rule:t}})}};var Nr=[Ir,gr,xr,vr,Ar,_r];function ie(e={},t={}){return e._validator||(e._validator=u({},t))}var Ft=class{constructor(){ie(this,{installed:{}}),Nr.forEach(t=>this.install(t))}static create(...t){return new Ft(...t)}},I=Ft;N(I,"exceptions",{CONFLICTED_NAME:"VALIDATOR_CONFLICTED_NAME",VALIDATION_FAILED:"VALIDATOR_VALIDATION_FAILED",UNSUPPORTED_VALIDATION:"VALIDATOR_UNSUPPORTED_VALIDATION",UNSUPPORTED_VALIDATION_RULE:"VALIDATOR_UNSUPPORTED_VALIDATION_RULE"});var Tr="valOf";function $e(e={}){let t=e[Tr];e=Y.exclude(e,[Tr]);let r=Object.keys(e)[0],o=e[r];return{name:r,rule:o,value:t}}I.prototype.mustbeSupported=function(e={},t={}){h.object(e,"Validation struct");let r="strict"in t?t.strict:!0,{name:o,rule:i}=$e(e),{installed:l}=ie(this),a=l[o];if(!a&&E({type:I.exceptions.UNSUPPORTED_VALIDATION,message:`Unsupported validator "${o}"`}),!(!r||!a.ruleType))try{if(_.mustWithin({type:_.get(i),types:a.ruleType}),a.validateRule){let n=a.validateRule(i);if(n)throw new Error(n)}}catch(n){E({type:I.exceptions.UNSUPPORTED_VALIDATION_RULE,message:n.message||"Unsupported validation rule."})}};I.prototype.error=function(e={},t){let r=null;try{this.mustbeSupported(e)}catch(o){r=o}if(!r){let{installed:o}=ie(this),{name:i,rule:l,value:a}=$e(e);arguments.length>1&&(a=t);let n=o[i],[s,p]=[_.get(a),n.valueType];try{_.mustWithin({type:s,types:p})}catch(d){r=d}r||(r=n.validate(a,l))}return r?D.create({type:I.exceptions.VALIDATION_FAILED,message:(()=>{let o="Not valid.";return m.string(r)?r:r instanceof Error&&r.message||o})()}):null};I.prototype.for=function(e="*",t={}){let[r,o]=[[],ie(this).installed],i="except"in t?t.except:[];return b.array(i)&&(i=[i]),Object.values(o).forEach(l=>{i.includes(l.name)||!_.within({type:e,types:l.valueType})||r.push(u({},l))}),r.length?r:null};I.prototype.install=function(e={}){h.object(e,"Validator installer");let{name:t,valueType:r,ruleType:o,validate:i,validateRule:l}=e;h.nonblankString(t,'Validator installer "name"'),h.type(r,'Validator installer "valueType"'),h.function(i,'Validator installer "validate"'),o&&h.type(o,'Validator installer "ruleType"'),l&&h.function(l,'Validator "validateRule"');let{installed:a}=ie(this);t in a&&E({type:I.exceptions.CONFLICTED_NAME,message:`Validator name ${t} has been occupied.`}),a[t]=x(u({},e),{name:t,valueType:r,ruleType:o,validate:i,validateRule:l})};I.prototype.isSupported=function(...e){try{this.mustbeSupported(...e)}catch(t){return!1}return!0};I.prototype.isValid=function(...e){return!this.error(...e)};I.prototype.isntSupported=function(...e){return!this.isSupported(...e)};I.prototype.isntValid=function(...e){return!this.isValid(...e)};I.prototype.uninstall=function(e=""){let{installed:t}=ie(this);e in t&&delete t[e]};function Pt(e){return I.create()}function Dt(e){return k.create()}function qe(e,t){!(t in j(e).installed)&&E({type:e.exceptions.UNINSTALLED_MEMBER_TYPE,message:`Member type ${t} is not installed.`})}function So(e,t={},r){let{hook:o,handler:i}=t;return b.array(o)&&(o=[o]),b.array(i)&&(i=[i]),i=i.map(l=>l.bind(e)),r?(i=i.map(l=>(a,...n)=>{let s=e.get({id:a.id,prop:"type"});if(s||(s=(a.props||{}).type||"default"),qe(e,s),s===r)return l(a,...n)}),{hook:o,handler:i}):{hook:o,handler:i}}function Vt(e,t={}){if(!e)return;let r=t.only;b.array(e)&&(e=[e]),e.forEach(o=>{let{hook:i,handler:l}=So(this,o,r);i.forEach(a=>l.forEach(n=>this.hooks.add(a,n)))})}function wt(e){return e.hooks.mount=Vt.bind(e),e.hooks}function Mt(e){let t=e.get;return e.get=function(r={},o={}){let{id:i,prop:l}=r,a=t.call(e,r,o);if(!a||!a.raw)return a;if("prop"in r){let n=a.raw.value;a.raw.value=Sr(e,i,l,n)}else Object.keys(a.raw.values).forEach(n=>{let s=a.raw.values[n];a.raw.values[n]=Sr(e,i,n,s)});return a}}function Sr(e,t,r,o){return be.includes(r)||!e.schema.for({id:t,prop:r}).schemable?o:dr(e,o)}function Or(e={}){let{installed:t}=j(this),r=e.type,o=m.function(e.collect)?e.collect:null,i=m.function(e.seed)?e.seed:null,l="hooks"in e?e.hooks:[],a="schema"in e?e.schema:{},n="props"in a?a.props:[],s="fallback"in a?a.fallback:{},p="reference"in a?a.reference:{},d="parse"in p?p.parse:null,f="stringify"in p?p.stringify:null;h.nonblankString(r,'Reactive Member "type"'),i&&h.function(i,'Reactive Member "seed"'),o&&h.function(o,'Reactive Member "collect"'),d&&h.function(d,'Reactive Member "schema.reference.parse"'),f&&h.function(f,'Member "schema.reference.stringify"'),h.array(n,'Reactive Member "schema.props"'),h.object(s,'Reactive Member "schema.fallback"'),h.array(l,'Reactive Member "hooks"'),n.forEach(g=>h.object(g,"Reactive Member prop schema")),l=l.flat(1/0),l.forEach(g=>{let{hook:C,handler:T,scope:F}=g;F&&h.nonblankString(F,'Reactive Member hook "scope"'),C=m.array(C)?C:[C],T=m.array(T)?T:[T],C.forEach(M=>h.nonblankString(M,'Reactive Member hook "type"')),T.forEach(M=>h.function(M,'Reactive Member hook "handler"'))}),r in t&&E({type:this.exceptions.CONFLICTED_MEMBER_TYPE,message:`Reactive Member type '${r}' has been occupied.`}),t[r]={config:{type:r,hooks:l,collect:o,seed:i,schema:{fallback:s,props:n,reference:{parse:d,stringify:f}}}},l.forEach(g=>{if(!g.scope)return this.hooks.mount(g,{only:r});let C=m.array(g.hook)?g.hook:[g.hook];(m.array(g.handler)?g.handler:[g.handler]).forEach(F=>C.forEach(M=>{Object.keys(t).some(W=>W!==r&&t[W].config.hooks.some(K=>{let xe=m.array(K.hook)?K.hook:[K.hook],$t=m.array(K.handler)?K.handler:[K.handler];return K.scope===g.scope&&$t.includes(F)&&xe.includes(M)}))||this.hooks.mount(x(u({},g),{hook:M,handler:F}),{only:g.scope})}))})}function Ut(e={},t={}){let{id:r}=e;if(this.family.hasnt({id:r}))return null;let o="errors"in t?t.errors:!0,[i,l]=[t.only||[],t.except||[]];b.array(i)&&(i=[i]),b.array(l)&&(l=[l]);let{values:a,raw:n}=Lr(this,r);if(a=jt(this,a,i,l),n.values=jt(this,n.values,i,l),!o)return{values:a,raw:n};let[s,p]=Oo(this,r);return{values:a,errors:s,raw:x(u({},n),{errors:p})}}function Lr(e,t){let r=e.get({id:t,prop:"type"}),o=j(e).installed[r].config.collect;if(o){let n=o.call(e,{id:t});return n||(n={}),n.values||(n.values={}),n.raw||(n.raw={}),n.raw.values||(n.raw.values={}),n}let{values:i,raw:l}=e.get({id:t},{include:"raw"});i.children=[],l.values.children=[];let a=e.family.descendant({id:t});return a?(a.forEach(n=>{let s=Lr(e,n.id);i.children.push(s.values),l.values.children.push(s.raw.values)}),{values:i,raw:l}):{values:i,raw:l}}function jt(e,t={},r=[],o=[]){return Object.keys(t).forEach(i=>{r.length&&!r.includes(i)&&delete t[i],o.length&&o.includes(i)&&delete t[i]}),t.children&&t.children.forEach((i,l)=>{t.children[l]=jt(e,i,r,o)}),t}function Oo(e,t){let[r,o]=[[],[]];return e.family.descendant({id:t},{deep:!0,self:!0}).forEach(({id:l})=>{let a=e.get({id:l},{include:["raw","error"]});a.errors&&r.push({id:l,errors:a.errors}),a.raw.errors&&o.push({id:l,errors:a.raw.errors})}),[r.length?r:null,o.length?o:null]}function Ht(e={},t={},r={}){let o="execute"in r?r.execute:!0;if(o&&this.family.hasnt({id:e.id}))return;let[i,l,a]=[null,[{id:e.id,props:t}],[]];for(;i=l.shift();){let[n,s]=[i.id,i.props],p=this.family.has({id:n}),d=(()=>p?this.get({id:n,prop:"type"}):s.type||"default")(),f=j(this).installed[d].config.seed;if(f){let g=f.call(this,{id:n},s);g&&(a=a.concat(g))}else Object.keys(s).forEach(g=>{if(g!=="children"){let F={action:"set",id:n,prop:g,value:s[g]};return a.push(F)}let[C,T]=[n,this.family.descendant({id:n})||[]];s.children.forEach((F,M)=>{if(T[M])return l.push({id:T[M].id,props:F});let[S,W,K]=[P(),F.name,F.type||"default"],xe={action:"add",parentId:C,id:S,props:{type:K,name:W}};a.push(xe),l.push({id:S,props:x(u({},F),{type:K})})})})}return o?this.executor.run(a):a}var Lo=[{hook:"before-add",handler(e){let t=(e.props||{}).type||"default";qe(this,t)}}],kr=Lo;var ko=[{hook:"before-del",handler(e){let{id:t}=e,{family:r,dependency:o}=this,i=r.descendant({id:t},{self:!0}),l={self:!1,group:Ke};o.reliers(i,l)&&E({type:this.exceptions.CONSTRAINTS_EXIST,message:he.t("reactive.memberIsReferenced",{variables:{id:t}})})}}],Rr=ko;var Ro=[{hook:"after-add",handler(e){let[t,r]=[e.id,(e.props||{}).type||"default"],[o,i]=[this.members,this.naming("type")];o[t][i.raw.prop]=o[t][i.prop]=r,o[t][i.raw.error]=o[t][i.error]=null}},{hook:"before-del",handler(e){let t=this.get({id:e.id,prop:"type"});e.props||(e.props={}),e.props.type=t}}],Cr=Ro;var Co=[{hook:"before-add",handler(e){let{id:t,props:r}=e;r||(e.props={}),e.props.name||(e.props.name=t)}},{hook:"after-add",handler(e){let{id:t,props:r}=e,[o,i]=[this.members,this.naming("name")];o[t][i.raw.prop]=o[t][i.prop]=r.name,o[t][i.raw.error]=o[t][i.error]=null}},{hook:"after-set",handler(e){let{id:t,prop:r,value:o}=e;if(r!=="name")return;let[i,l]=[this.members,this.naming("name")];i[t][l.raw.prop]=i[t][l.prop]=o,i[t][l.raw.error]=i[t][l.error]=null}}],Fr=Co;var Fo=[{hook:["before-set","before-calc"],handler(e){if(e.prop==="type")return!1}}],Pr=Fo;function Dr(e,t,r){let o=e.family.sibling({id:t});!o||o.find(({id:i})=>e.get({id:i,prop:"name"})===r)&&E({type:e.exceptions.CONFLICTED_MEMBER_NAME,message:he.t("reactive.conflictedMemberName",{variables:{name:r}})})}var Po=[{hook:"after-add",handler(e){let{id:t}=e,r=this.get({id:t,prop:"name"});pt.blank(r,he.t("reactive.memberNameRequired")),Dr(this,t,r)}},{hook:"after-set",handler(e){let{id:t,prop:r}=e;if(r!=="name")return;let o=this.get({id:t,prop:r},{include:["error","raw"]});if(o.raw.error){let i=`Skipping validating name of member ${t},`;return i+=" since prev errors exist.",console.warn(i,o.raw.error)}try{pt.blank(o.raw.value,he.t("reactive.memberNameRequired")),Dr(this,t,o.raw.value)}catch(i){this.members[t][this.naming(r).raw.error]=[i]}}}],Vr=Po;var Do=[{hook:"after-set",handler(e){let{id:t,prop:r}=e;if(be.includes(r)||!this.schema.for({id:t,prop:r}).schemable)return;let i=this.constructor.prototype.get.call(this,{id:t,prop:r},{include:["raw","error"]});if(i.raw.error){let n=`Skipping translating ${r} schema of member ${t},`;return n+=" since previous errors exist.",console.warn(n,i.raw.error)}let[l,a]=[this.members,this.naming(r)];try{l[t][a.raw.prop]=mr(this,i.raw.value)}catch(n){l[t][a.raw.error]=[n]}}},{hook:"after-set",handler(e){let{id:t,prop:r}=e,{schema:o,dependency:i,family:l,members:a}=this;if(be.includes(r)||!o.for({id:t,prop:r}).schemable)return;i.delete({id:t,prop:r},{only:"relier",group:Ke});let s=this.constructor.prototype.get.call(this,{id:t,prop:r},{include:["raw","error"]});if(s.raw.error){let f="Skipping adding new associations for";return f+=` member ${t}'s ${r} since previous errors exist.`,console.warn(f,s.raw.error)}let p=o.references(s.raw.value);if(!p)return;let d=p.map(f=>({relier:{id:t,prop:r},provider:JSON.parse(f)}));d.forEach(f=>{let{provider:g,relier:C}=f,T={self:!0,deep:!0},F=l.ancestor({id:g.id},T);F.forEach((M,S)=>{S!==F.length-1&&d.push({relier:C,provider:{id:M.id,prop:"name"}})})});try{i.add(d,{group:Ke})}catch(f){a[t][this.naming(r).raw.error]=[f]}}},{hook:"after-calc",handler(e){let{id:t,prop:r}=e;if(be.includes(r)||!this.schema.for({id:t,prop:r}).schemable)return;let o=this.constructor.prototype.get,{value:i,error:l}=o.call(this,{id:t,prop:r},{include:"error"}),[a,n]=[this.members,this.naming(r)];if(l){a[t][n.prop]=null;let s=`Skipping parsing ${r} schema of member ${t},`;return s+=" since previous errors exist.",console.warn(s,l)}try{a[t][n.prop]=this.schema.parse(i)}catch(s){a[t][n.prop]=null,a[t][n.error]=[s],console.warn(`Failed to parse ${r} schema of member ${t}.`,s)}}}],wr=Do;var Vo=[{hook:"after-calc",handler(e){let{id:t,prop:r}=e;if(be.includes(r))return;let o=this.schema.for({id:t,prop:r});if(!o.schemable||!o.calculable)return;let i=this.constructor.prototype.get,{value:l,error:a}=i.call(this,{id:t,prop:r},{include:"error"}),[n,s]=[this.members,this.naming(r)];if(a){let p=`Skipping trying to calculate ${r} of member ${t},`;return p+=" since previous errors exist.",console.warn(p,a)}if(!!this.calculator.isSupported(l,{strict:!1}))try{n[t][s.prop]=this.calculator.calculate(l)}catch(p){n[t][s.error]=[p],console.warn(`Failed to calculate ${r} of member ${t}.`,p)}}}],Mr=Vo;var wo=[{hook:"after-add",handler(e,t){let[r,o]=[e.id,t.mutations.set];this.schema.for({id:r}).forEach(i=>{o.find(l=>l.prop===i.prop)||o.push({id:r,prop:i.prop,value:i.default})})}}],Ur=wo;var Mo=[{hook:"after-add",handler(e,t){let[r,o]=[e.id,t.mutations.set];this.schema.for({id:r}).forEach(i=>{if(!("always"in i))return;let l=o.find(a=>a.prop===i.prop);if(l)return l.value=i.always;o.push({id:r,prop:i.prop,value:i.always})})}},{hook:"before-set",handler(e){let{id:t,prop:r,value:o}=e,i=this.schema.for({id:t,prop:r});"always"in i&&o!==i.always&&(e.value=i.always)}}],jr=Mo;var Uo=[{hook:"after-add",handler(e,t){let[r,o]=[e.id,t.mutations.set];this.schema.for({id:r}).forEach(i=>{!i.validation||o.find(l=>l.prop===i.prop)||o.push({id:r,prop:i.prop,value:i.default||null})})}},{hook:"after-calc",handler(e){let{id:t,prop:r}=e,{value:o,error:i}=this.get({id:t,prop:r},{include:"error"});if(i&&(b.array(i)&&(i=[i]),i=i.find(p=>p.type!==I.exceptions.VALIDATION_FAILED),i)){let p=`Skipping validating ${r} of member ${t},`;return p+=" since previous errors exist.",console.warn(p,i)}let{validation:l}=this.schema.for({id:t,prop:r}),[a,n]=[this.members,this.naming(r)];if(!l||(b.array(l)&&(l=[l]),(l.find(p=>"presence"in p)||b.blank(o))&&l.some(p=>{try{return m.function(p)?i=p.call(this,{id:t,prop:r,value:o}):i=this.validator.error(p,o)}catch(d){return i=d}}),!i))return a[t][n.error]=null;a[t][n.error]=[D.create({type:I.exceptions.VALIDATION_FAILED,message:m.string(i)?i:i.message||i.name})]}}],Hr=Uo;var Br=[];function Bt(e={}){let t=e.accept;b.array(t)&&(t=[t]),t.forEach(o=>h.nonblankString(o));let r=Br.find(o=>o.accept.length!==t.length?!1:!o.accept.some(i=>!t.includes(i)));return r||(r={accept:t,HOOKS:[{hook:"before-add",handler(o){let i=(o.props||{}).type||"default",l=this.get({id:o.parentId,prop:"type"});!t.includes(l)&&E({type:this.exceptions.INVALID_PARENT,message:he.t("reactive.mustBelongsToValidParent",{variables:{memberType:i,acceptedParentTypes:t}})})}}]},Br.push(r)),r.HOOKS}var Kt={CONFLICTED_MEMBER_TYPE:"REACTIVE_CONFLICTED_MEMBER_TYPE",UNINSTALLED_MEMBER_TYPE:"REACTIVE_UNINSTALLED_MEMBER_TYPE",CONSTRAINTS_EXIST:"REACTIVE_CONSTRAINTS_EXIST",CONFLICTED_MEMBER_NAME:"REACTIVE_CONFLICTED_MEMBER_NAME",REFERENCED_PROVIDER_NOT_FOUND:"REACTIVE_REFERENCED_PROVIDER_NOT_FOUND",INVALID_PARENT:"REACTIVE_INVALID_PARENT",HOOK_NOT_EXIST:"REACTIVE_HOOK_NOT_EXIST",VALIDATION_FAILED:"REACTIVE_VALIDATION_FAILED"},it={ENABLE_SCHEMA_DEFAULT:Ur,ENABLE_SCHEMA_ALWAYS:jr,ENABLE_SCHEMA_VALIDATION:Hr,BLOCK_INVALID_PARENT:Bt};function A(){let e=R.create();j(e,{installed:{}}),e.guid=P,e.exceptions=Kt,e.seed=Ht.bind(e),e.collect=Ut.bind(e),e.install=Or.bind(e),e.get=Mt(e),e.schema=Ct(e),e.validator=Pt(e),e.calculator=Dt(e),e.hooks=wt(e),e.hooks.mount(kr),e.hooks.mount(Rr),e.hooks.mount(Cr),e.hooks.mount(Fr),e.hooks.mount(Pr),e.hooks.mount(Vr),e.hooks.mount(wr),e.hooks.mount(Mr),e.install({type:"default",schema:{props:[{prop:"name"}]}});let t=e.members[e.family.root().id],r=e.naming("type");return t[r.raw.prop]=t[r.prop]="default",e}A.guid=P;A.exceptions=Kt;A.hooks={use(e,...t){return!(e in it)&&E({type:Kt.HOOK_NOT_EXIST}),b.function(it[e])?it[e]:it[e](...t)}};Ae.hooks=[A.hooks.use("ENABLE_SCHEMA_DEFAULT"),A.hooks.use("ENABLE_SCHEMA_VALIDATION")];var Kr={schema:{props:{name:{label:"Fieldset Name"},label:{label:"Fieldset Title",default:""},description:{label:"Fieldset Description",default:""}}}};var Yr={schema:{props:{name:{label:"\u8F93\u5165\u9879\u96C6\u5408Name"},label:{label:"\u8F93\u5165\u9879\u96C6\u5408\u6807\u9898",default:""},description:{label:"\u8F93\u5165\u9879\u96C6\u5408\u63CF\u8FF0",default:""}}}};z.define({en:{form:{fieldset:Kr}},zh:{form:{fieldset:Yr}}});var Z=z;Ae.schema={fallback:{prop:()=>A.guid(),label:()=>A.guid(),default:null,schemable:!1,calculable:!1,validation:null,placeholder:()=>Z.t("form.fieldset.schema.fallback.placeholder"),hint:()=>Z.t("form.fieldset.schema.fallback.hint")},props:[{prop:"name",label:()=>Z.t("form.fieldset.schema.props.name.label"),placeholder:()=>Z.t("form.fieldset.schema.props.name.placeholder"),hint:()=>Z.t("form.fieldset.schema.props.name.hint")},{prop:"label",schemable:!1,calculable:!1,validation:[{dataType:"String"}],default:()=>Z.t("form.fieldset.schema.props.label.default"),label:()=>Z.t("form.fieldset.schema.props.label.label"),placeholder:()=>Z.t("form.fieldset.schema.props.label.placeholder"),hint:()=>Z.t("form.fieldset.schema.props.label.hint")},{prop:"description",schemable:!1,calculable:!1,validation:[{dataType:"String"}],default:()=>Z.t("form.fieldset.schema.props.description.default"),label:()=>Z.t("form.fieldset.schema.props.description.label"),placeholder:()=>Z.t("form.fieldset.schema.props.description.placeholder"),hint:()=>Z.t("form.fieldset.schema.props.description.hint")}]};var c=class{};N(c,"GROUP_NAME","field"),N(c,"PARENT_TYPE","Fieldset"),N(c,"exceptions",{PROP_SCHEMA_NOT_EXIST:"FIELD_PROP_SCHEMA_NOT_EXIST",HOOK_NOT_EXIST:"FIELD_HOOK_NOT_EXIST",INVALID_PARENT:"FIELD_INVALID_PARENT",UNINSTALLED_TYPE:"FIELD_UNINSTALLED_TYPE"});c.extend=function(e={}){let{type:t,hooks:r,schema:o}=u({},e);return!r&&(r=c.hooks.default()),!o&&(o=c.schema.default()),!o.fallback&&(o.fallback=c.schema.default("fallback")),!o.props&&(o.props=c.schema.default("props")),x(u({},e),{group:c.GROUP_NAME,type:t,hooks:r,schema:o})};var $r={hooks:{calculationNotSupported:"Unsupported calculation algorithm { name }."},schema:{props:{name:{label:"Name"},label:{label:"Label",default:"Form Field"},value:{label:"Value"},placeholder:{label:"Placeholder",default:""},editable:{label:"If Editable"},visible:{label:"If Visible"},validation:{label:"Validation"},calculation:{label:"Calculation",placeholder:'E.g, {add: ["<< fields.age.value >>", "<< fields.count.value >>"]}'},options:{label:"Options",mustbeUnique:"Option value must be unique.",optionLabel:"Option"}}},textField:{schema:{props:{label:{default:"Text Field"}}}},numberField:{schema:{props:{label:{default:"Number Field"}}}},singleSelectField:{schema:{props:{label:{default:"Single Select"}}}},multipleSelectField:{schema:{props:{label:{default:"Multiple Select"}}}},radioField:{schema:{props:{label:{default:"Radio Field"}}}},checkboxField:{schema:{props:{label:{default:"Checkbox Field"}}}}};var qr={hooks:{calculationNotSupported:"\u4E0D\u88AB\u652F\u6301\u7684\u8BA1\u7B97{ name }."},schema:{props:{name:{label:"\u8F93\u5165\u9879Name"},label:{label:"\u6807\u9898",default:"\u8F93\u5165\u9879"},value:{label:"\u521D\u59CB\u503C"},placeholder:{label:"\u5360\u4F4D\u7B26",default:""},editable:{label:"\u662F\u5426\u53EF\u7F16\u8F91"},visible:{label:"\u662F\u5426\u53EF\u89C1"},validation:{label:"\u6821\u9A8C\u89C4\u5219"},calculation:{label:"\u8BA1\u7B97\u89C4\u5219",placeholder:'\u4F8B\u5982: {add: ["<< fields.age.value >>", "<< fields.count.value >>"]}'},options:{label:"\u9009\u9879",mustbeUnique:"\u9009\u9879\u503C\u4E0D\u80FD\u91CD\u590D\u3002",optionLabel:"\u9009\u9879"}}},textField:{schema:{props:{label:{default:"\u5355\u884C\u6587\u672C"}}}},numberField:{schema:{props:{label:{default:"\u6570\u5B57"}}}},singleSelectField:{schema:{props:{label:{default:"\u4E0B\u62C9\u5355\u9009"}}}},multipleSelectField:{schema:{props:{label:{default:"\u4E0B\u62C9\u591A\u9009"}}}},radioField:{schema:{props:{label:{default:"\u5355\u9009"}}}},checkboxField:{schema:{props:{label:{default:"\u591A\u9009"}}}}};z.define({en:{form:{field:$r}},zh:{form:{field:qr}}});var v=z;var jo=[{hook:"after-add",handler(e){let t={id:e.id,prop:"value"},r={id:e.id,prop:"calculation"};this.dependency.add({provider:r,relier:t})}},{hook:"after-set",handler(e){let{id:t,prop:r}=e;if(r!=="calculation")return;let o=this.get({id:t,prop:r},{include:["error","raw"]});if(o.raw.error){let n="Skipping checking whether calculations are supported";return n+=" since prev errors exist.",console.warn(n,o.raw.error)}if(!o.raw.value)return;let i=this.schema.possibilities(o.raw.value);i||(i=[o.raw.value]);let[l,a]=[this.members,this.naming(r)];i.some(n=>!n||this.calculator.isSupported(n,{strict:!1})?!1:(n=m.object(n)?JSON.stringify(n):n,l[t][a.raw.error]=[D.create({type:k.exceptions.UNSUPPORTED_CALCULATION,message:v.t("form.hooks.calculationNotSupported",{variables:{name:n}})})],!0))}},{hook:"after-calc",handler(e){let{id:t,prop:r}=e;if(r!=="calculation")return;let o=this.get({id:t,prop:r},{include:["raw","error"]});if(o.error)return console.warn("Skipping using calculated value since prev errors exist.",o.error);!o.raw.value||this.set({id:t,prop:"value",value:o.value})}},{hook:"before-set",handler(e){let{id:t,prop:r,value:o}=e;if(r!=="value")return;let i=this.get({id:t,prop:"calculation"},{include:"raw"});if(i.raw.value&&o!==i.value)return!1}}],Gr=jo;var Ho=[{hook:"after-add",handler(e){let t={id:e.id,prop:"value"},r={id:e.id,prop:"validation"};this.dependency.add({provider:r,relier:t})}},{hook:"after-calc",handler(e){let{id:t,prop:r}=e;if(r!=="value")return;let o=this.get({id:t,prop:"validation"},{include:"error"});if(o.error){let p=`Skipping validating ${r} using field validation`;return p+=" since field validation has errors.",console.warn(p,o.error)}if(!o.value)return;let{value:i,error:l}=this.get({id:t,prop:r},{include:"error"});if(l){let p="Skipping validating value using validation rules";return p+=" since prev value errors exist.",console.warn(p,l)}b.array(o.value)&&(o.value=[o.value]),(o.value.find(p=>p&&"presence"in p)||b.blank(i))&&o.value.some(p=>{try{return l=this.validator.error(p,i)}catch(d){return l=d}});let[n,s]=[this.members,this.naming(r)];if(!l)return n[t][s.error]=null;n[t][s.error]=[D.create({type:I.exceptions.VALIDATION_FAILED,message:m.string(l)?l:l.message||l.name})]}}],zr=Ho;var Bo=[{hook:"after-add",handler(e){let t={id:e.id,prop:"value"},r={id:e.id,prop:"options"};this.dependency.add({provider:r,relier:t})}},{hook:"after-calc",handler(e){let{id:t,prop:r}=e;if(r!=="value")return;let{value:o,error:i}=this.get({id:t,prop:r},{include:"error"});if(i){let d="Skipping checking if value is within field options";return d+=" since prev value errors exist.",console.warn(d,i)}let l=this.get({id:t,prop:"options"},{include:"error"});if(l.error){let d="Skipping checking if value is within field options";return d+=" since field options has errors.",console.warn(d,l.error)}if(!l.value)return;let[a,n]=[this.members,this.naming(r)];if(m.blank(o))return a[t][n.error]=null;let s=l.value.map(d=>d.value);if(b.array(o)&&(o=[o]),!o.some(d=>!s.includes(d)))return a[t][n.error]=null;a[t][n.error]=[D.create({type:I.exceptions.VALIDATION_FAILED,message:"Each picked value must be included in option values."})]}}],Wr=Bo;var lt={ENABLE_VALUE_CALCULATION:Gr,ENABLE_VALUE_VALIDATION:zr,ENSURE_VALUE_WITHIN_OPTIONS:Wr},Ko=[A.hooks.use("BLOCK_INVALID_PARENT",{accept:c.PARENT_TYPE}),A.hooks.use("ENABLE_SCHEMA_DEFAULT"),lt.ENABLE_VALUE_CALCULATION,A.hooks.use("ENABLE_SCHEMA_VALIDATION"),lt.ENABLE_VALUE_VALIDATION];c.hooks={use(e){return!(e in lt)&&E({type:c.exceptions.HOOK_NOT_EXIST}),lt[e]},default(){return Ko.slice()}};var Ge={FALLBACK:{prop:()=>P(),label:()=>P(),default:null,schemable:!1,calculable:!1,validation:null,placeholder:()=>v.t("form.field.schema.fallback.placeholder"),hint:()=>v.t("form.field.schema.fallback.hint")},PROPS:[{prop:"name",label:()=>v.t("form.field.schema.props.name.label"),placeholder:()=>v.t("form.field.schema.props.name.placeholder"),hint:()=>v.t("form.field.schema.props.name.placeholder")},{prop:"label",schemable:!1,calculable:!1,validation:[{presence:!0},{dataType:"String"}],default:()=>v.t("form.field.schema.props.label.default"),label:()=>v.t("form.field.schema.props.label.label"),placeholder:()=>v.t("form.field.schema.props.label.placeholder"),hint:()=>v.t("form.field.schema.props.label.hint")},{prop:"value",schemable:!1,calculable:!1,validation:null,default:null,label:()=>v.t("form.field.schema.props.value.label"),placeholder:()=>v.t("form.field.schema.props.value.placeholder"),hint:()=>v.t("form.field.schema.props.value.hint")},{prop:"placeholder",schemable:!1,calculable:!1,validation:[{dataType:"String"}],default:()=>v.t("form.field.schema.props.placeholder.default"),label:()=>v.t("form.field.schema.props.placeholder.label"),placeholder:()=>v.t("form.field.schema.props.placeholder.placeholder"),hint:()=>v.t("form.field.schema.props.placeholder.hint")},{prop:"editable",schemable:!0,calculable:!0,validation:[{presence:!0},{dataType:"Boolean"}],default:!0,label:()=>v.t("form.field.schema.props.editable.label"),placeholder:()=>v.t("form.field.schema.props.editable.placeholder"),hint:()=>v.t("form.field.schema.props.editable.hint")},{prop:"visible",schemable:!0,validation:[{presence:!0},{dataType:"Boolean"}],default:!0,label:()=>v.t("form.field.schema.props.visible.label"),placeholder:()=>v.t("form.field.schema.props.visible.placeholder"),hint:()=>v.t("form.field.schema.props.visible.hint")},{prop:"validation",schemable:!0,calculable:!0,validation:[{dataType:"Array"}],default:null,label:()=>v.t("form.field.schema.props.validation.label"),placeholder:()=>v.t("form.field.schema.props.validation.placeholder"),hint:()=>v.t("form.field.schema.props.validation.hint")},{prop:"calculation",schemable:!0,calculable:!0,validation:null,default:null,label:()=>v.t("form.field.schema.props.calculation.label"),placeholder:()=>v.t("form.field.schema.props.calculation.placeholder"),hint:()=>v.t("form.field.schema.props.calculation.hint")}]},Yo={PROPS:[{prop:"options",schemable:!1,calculable:!1,default:()=>[{value:"1",label:v.t("form.field.schema.props.options.optionLabel")+" 1"}],label:()=>v.t("form.field.schema.props.options.label"),placeholder:()=>v.t("form.field.schema.props.options.placeholder"),hint:()=>v.t("form.field.schema.props.options.hint"),validation:[{presence:!0},{dataType:"Array"},function(e){let t=e.value;t.forEach((r,o)=>{h.object(r,"Each option"),h.string(r.label,"Option label"),h.string(r.value,"Option value"),t.some((i,l)=>l!==o&&i.value===r.value)&&E({type:I.exceptions.VALIDATION_FAILED,message:v.t("form.field.schema.props.options.mustbeUnique")})})}]}]};c.schema={use(e){return u({},Xr(e))},extend(e,t={}){return u(u({},Xr(e)),t)},default(e){return e==="fallback"?u({},Ge.FALLBACK):e==="props"?Ge.PROPS.slice():{fallback:u({},Ge.FALLBACK),props:Ge.PROPS.slice()}}};function Xr(e){let r=Ge.PROPS.concat(Yo.PROPS).find(o=>o.prop===e);return!r&&E({type:c.exceptions.PROP_SCHEMA_NOT_EXIST,message:`Prop schema of '${e}' does not exist.`}),r}function y(e="",t="",r){return m.undefined(r)&&(r=["label","placeholder","hint"]),Y.from(r.map(o=>[o,$o(e,t,o)]))}function $o(e,t,r){return()=>v.try([`form.field.${e}.schema.props.${t}.${r}`,`form.field.schema.props.${t}.${r}`])}var Jr=c.extend({type:"CheckboxField",hooks:[A.hooks.use("BLOCK_INVALID_PARENT",{accept:c.PARENT_TYPE}),A.hooks.use("ENABLE_SCHEMA_DEFAULT"),c.hooks.use("ENABLE_VALUE_CALCULATION"),A.hooks.use("ENABLE_SCHEMA_VALIDATION"),c.hooks.use("ENSURE_VALUE_WITHIN_OPTIONS"),c.hooks.use("ENABLE_VALUE_VALIDATION")],schema:{props:[c.schema.extend("name",u({},y("checkboxField","name"))),c.schema.extend("label",u({},y("checkboxField","label",["label","placeholder","hint","default"]))),c.schema.extend("value",x(u({},y("checkboxField","value")),{validation:[{dataType:"Array"}]})),c.schema.extend("options",u({},y("checkboxField","options"))),c.schema.extend("editable",u({},y("checkboxField","editable"))),c.schema.extend("visible",u({},y("checkboxField","visible"))),c.schema.extend("validation",u({},y("checkboxField","validation"))),c.schema.extend("calculation",u({},y("checkboxField","calculation")))]}});var Zr=c.extend({type:"MultipleSelectField",hooks:[A.hooks.use("BLOCK_INVALID_PARENT",{accept:c.PARENT_TYPE}),A.hooks.use("ENABLE_SCHEMA_DEFAULT"),c.hooks.use("ENABLE_VALUE_CALCULATION"),A.hooks.use("ENABLE_SCHEMA_VALIDATION"),c.hooks.use("ENSURE_VALUE_WITHIN_OPTIONS"),c.hooks.use("ENABLE_VALUE_VALIDATION")],schema:{props:[c.schema.extend("name",u({},y("multipleSelectField","name"))),c.schema.extend("label",u({},y("multipleSelectField","label",["label","placeholder","hint","default"]))),c.schema.extend("placeholder",u({},y("multipleSelectField","placeholder",["label","placeholder","hint","default"]))),c.schema.extend("value",x(u({},y("multipleSelectField","value")),{validation:[{dataType:"Array"}]})),c.schema.extend("options",u({},y("multipleSelectField","options"))),c.schema.extend("editable",u({},y("multipleSelectField","editable"))),c.schema.extend("visible",u({},y("multipleSelectField","visible"))),c.schema.extend("validation",u({},y("multipleSelectField","validation"))),c.schema.extend("calculation",u({},y("multipleSelectField","calculation")))]}});var Qr=c.extend({type:"NumberField",schema:{props:[c.schema.extend("name",u({},y("numberField","name"))),c.schema.extend("label",u({},y("numberField","label",["label","placeholder","hint","default"]))),c.schema.extend("placeholder",u({},y("numberField","placeholder",["label","placeholder","hint","default"]))),c.schema.extend("value",x(u({},y("numberField","value")),{validation:[{dataType:"Number"}]})),c.schema.extend("editable",u({},y("numberField","editable"))),c.schema.extend("visible",u({},y("numberField","visible"))),c.schema.extend("validation",u({},y("numberField","validation"))),c.schema.extend("calculation",u({},y("numberField","calculation")))]}});var eo=c.extend({type:"RadioField",hooks:[A.hooks.use("BLOCK_INVALID_PARENT",{accept:c.PARENT_TYPE}),A.hooks.use("ENABLE_SCHEMA_DEFAULT"),c.hooks.use("ENABLE_VALUE_CALCULATION"),A.hooks.use("ENABLE_SCHEMA_VALIDATION"),c.hooks.use("ENSURE_VALUE_WITHIN_OPTIONS"),c.hooks.use("ENABLE_VALUE_VALIDATION")],schema:{props:[c.schema.extend("name",u({},y("radioField","name"))),c.schema.extend("label",u({},y("radioField","label",["label","placeholder","hint","default"]))),c.schema.extend("value",x(u({},y("radioField","value")),{validation:[{dataType:"String"}]})),c.schema.extend("options",u({},y("radioField","options"))),c.schema.extend("editable",u({},y("radioField","editable"))),c.schema.extend("visible",u({},y("radioField","visible"))),c.schema.extend("validation",u({},y("radioField","validation"))),c.schema.extend("calculation",u({},y("radioField","calculation")))]}});var to=c.extend({type:"SingleSelectField",hooks:[A.hooks.use("BLOCK_INVALID_PARENT",{accept:c.PARENT_TYPE}),A.hooks.use("ENABLE_SCHEMA_DEFAULT"),c.hooks.use("ENABLE_VALUE_CALCULATION"),A.hooks.use("ENABLE_SCHEMA_VALIDATION"),c.hooks.use("ENSURE_VALUE_WITHIN_OPTIONS"),c.hooks.use("ENABLE_VALUE_VALIDATION")],schema:{props:[c.schema.extend("name",u({},y("singleSelectField","name"))),c.schema.extend("label",u({},y("singleSelectField","label",["label","placeholder","hint","default"]))),c.schema.extend("placeholder",u({},y("singleSelectField","placeholder",["label","placeholder","hint","default"]))),c.schema.extend("value",x(u({},y("singleSelectField","value")),{validation:[{dataType:"String"}]})),c.schema.extend("options",u({},y("singleSelectField","options"))),c.schema.extend("editable",u({},y("singleSelectField","editable"))),c.schema.extend("visible",u({},y("singleSelectField","visible"))),c.schema.extend("validation",u({},y("singleSelectField","validation"))),c.schema.extend("calculation",u({},y("singleSelectField","calculation")))]}});var ro=c.extend({type:"TextField",schema:{props:[c.schema.extend("name",u({},y("textField","name"))),c.schema.extend("label",u({},y("textField","label",["label","placeholder","hint","default"]))),c.schema.extend("placeholder",u({},y("textField","placeholder",["label","placeholder","hint","default"]))),c.schema.extend("value",x(u({},y("textField","value")),{validation:[{dataType:"String"}]})),c.schema.extend("editable",u({},y("textField","editable"))),c.schema.extend("visible",u({},y("textField","visible"))),c.schema.extend("validation",u({},y("textField","validation"))),c.schema.extend("calculation",u({},y("textField","calculation")))]}});var Yt=[ro,Qr,to,Zr,eo,Jr];var Q={type:"Subform"};Q.collect=function(e){let t=this.get({id:e.id},{include:"raw"}),[r,o]=[[],[]],[i,l]=[[],[]];return(this.family.descendant(e)||[]).forEach((a,n)=>{let[s,p]=[{},{}];(this.family.descendant(a)||[]).forEach(d=>{let f=this.collect({id:d.id},{errors:!1});s[f.values.name]=f.values.value,p[f.values.name]=f.raw.values.value,n===0&&(delete f.values.value,delete f.raw.values.value,i.push(f.values),l.push(f.raw.values))}),r.push(s),o.push(p)}),t.values.value=r,t.raw.values.value=o,t.values.children=i,t.raw.values.children=l,t};Q.hooks=[A.hooks.use("BLOCK_INVALID_PARENT",{accept:"Fieldset"}),A.hooks.use("ENABLE_SCHEMA_DEFAULT"),A.hooks.use("ENABLE_SCHEMA_VALIDATION")];var oo={schema:{props:{name:{label:"Name"},label:{label:"Label",default:"Subform"},editable:{label:"If Editable"},visible:{label:"If Visible"}}}};var io={schema:{props:{name:{label:"\u5B50\u8868\u5355Name"},label:{label:"\u5B50\u8868\u5355\u6807\u9898",default:"\u5B50\u8868\u5355"},editable:{label:"\u662F\u5426\u53EF\u7F16\u8F91"},visible:{label:"\u662F\u5426\u53EF\u89C1"}}}};z.define({en:{form:{subform:oo}},zh:{form:{subform:io}}});var H=z;Q.schema={fallback:{prop:()=>A.guid(),label:()=>A.guid(),default:null,schemable:!1,calculable:!1,validation:null,placeholder:()=>H.t("form.subform.schema.fallback.placeholder"),hint:()=>H.t("form.subform.schema.fallback.hint")},props:[{prop:"name",label:()=>H.t("form.subform.schema.props.name.label"),placeholder:()=>H.t("form.subform.schema.props.name.placeholder"),hint:()=>H.t("form.subform.schema.props.name.hint")},{prop:"label",schemable:!1,calculable:!1,validation:[{presence:!0},{dataType:"String"}],default:()=>H.t("form.subform.schema.props.label.default"),label:()=>H.t("form.subform.schema.props.label.label"),placeholder:()=>H.t("form.subform.schema.props.label.placeholder"),hint:()=>H.t("form.subform.schema.props.label.hint")},{prop:"editable",default:!0,schemable:!0,calculable:!0,validation:[{presence:!0},{dataType:"Boolean"}],label:()=>H.t("form.subform.schema.props.editable.label"),placeholder:()=>H.t("form.subform.schema.props.editable.placeholder"),hint:()=>H.t("form.subform.schema.props.editable.hint")},{prop:"visible",default:!0,schemable:!0,validation:[{presence:!0},{dataType:"Boolean"}],label:()=>H.t("form.subform.schema.props.visible.label"),placeholder:()=>H.t("form.subform.schema.props.visible.placeholder"),hint:()=>H.t("form.subform.schema.props.visible.hint")}]};Q.seed=function(e,t){let r=t.children||[],o=t.value||[];!o.length&&o.push({});let i=o.map(()=>{let[n,s]=[this.guid(),"SubformFieldset"];return{action:"add",parentId:e.id,id:n,props:{type:s}}}),l=Object.keys(t).map(n=>{if(!["children","value"].includes(n))return{action:"set",id:e.id,prop:n,value:t[n]}}).filter(n=>n),a=i.map((n,s)=>(r=r.map((p,d)=>{let g=m.object(o[s])&&p.name in o[s]?o[s][p.name]:null;return x(u({},p),{order:d,value:g})}),this.seed({id:n.id},{children:r},{execute:!1}))).flat();return i.concat(l,a).map(n=>x(u({},n),{__syncSubformField__:!0}))};var Ee={type:"SubformFieldset"};Ee.hooks=[A.hooks.use("BLOCK_INVALID_PARENT",{accept:"Subform"})];var B=class{};N(B,"GROUP_NAME","SubformField"),N(B,"PARENT_TYPE","SubformFieldset"),N(B,"TYPE_PREFIX","Subform"),N(B,"LABEL_PREFIX","Subform "),N(B,"exceptions",{INVALID_PARENT:"SUBFORM_FIELD_INVALID_PARENT",INVALID_FIELD_INSTALLER:"SUBFORM_FIELD_INVALID_FIELD_INSTALLER"});var qo=[{hook:"before-add",handler(e){let{parentId:t,props:r,__syncSubformField__:o}=e;if(o)return;let i=[x(u({},e),{action:"add",__syncSubformField__:!0})],l=this.family.sibling({id:t})||[];return i=i.concat(l.map(a=>({action:"add",__syncSubformField__:!0,parentId:a.id,id:this.guid(),props:r}))),this.executor.run(i),!1}},{hook:"before-del",handler(e){let{id:t,__syncSubformField__:r}=e;if(r)return;let o=[x(u({},e),{action:"del",__syncSubformField__:!0})],l=this.family.sibling({id:t},{self:!0}).findIndex(s=>s.id===t),a=this.family.ancestor({id:t}),n=this.family.sibling(a)||[];return o=o.concat(n.map(s=>({action:"del",__syncSubformField__:!0,id:this.family.descendant(s)[l].id}))),this.executor.run(o),!1}},{hook:"before-set",handler(e){let{id:t,prop:r,value:o,__syncSubformField__:i}=e;if(i||r==="value")return;let l=[x(u({},e),{action:"set",__syncSubformField__:!0})],n=this.family.sibling({id:t},{self:!0}).findIndex(d=>d.id===t),s=this.family.ancestor({id:t}),p=this.family.sibling(s)||[];return l=l.concat(p.map(d=>({action:"set",__syncSubformField__:!0,id:this.family.descendant(d)[n].id,prop:r,value:o}))),this.executor.run(l),!1}},{scope:Ee.type,hook:"after-add",handler(e){let{id:t,props:r}=e,o=this.family.sibling({id:t});if(!o)return;let i=this.collect({id:o[0].id}).raw.values.children;if(!i.length)return;let l=i.map((a,n)=>{let s=((r==null?void 0:r.children)||[])[n]||{},p="value"in s?s.value:null;return{action:"add",__syncSubformField__:!0,parentId:t,id:this.guid(),props:x(u({},a),{order:n,value:p})}});this.executor.run(l)}}],lo=qo;var Go=[{hook:"after-add",handler(e){let{id:t}=e,{family:r,dependency:o,schema:i}=this;if(!i.for({id:t}).find(p=>p.prop==="value"))return;let a=r.ancestor({id:t}),s={id:r.ancestor(a).id,prop:"value"};o.add({relier:s,provider:{id:t,prop:"name"}}),o.add({relier:s,provider:{id:t,prop:"value"}})}},{scope:Ee.type,hook:"after-add",handler(e){let{id:t}=e,{family:r,dependency:o}=this,l={id:r.ancestor({id:t}).id,prop:"value"};o.add({relier:l,provider:{id:t,prop:"order"}})}},{scope:Q.type,hook:"after-calc",handler(e){let{id:t,prop:r}=e;if(r!=="value")return;let{family:o}=this,i=(o.descendant({id:t})||[]).map(l=>Y.from((o.descendant(l)||[]).map(a=>{let n=this.get({id:a.id,prop:"name"}),s=this.get({id:a.id,prop:"value"});return[n,s]})));this.members[t][this.naming(r).prop]=i}}],ao=Go;B.generate=function(e={}){e.group!==c.GROUP_NAME&&E({type:B.exceptions.INVALID_FIELD_INSTALLER,message:`SubformField.generate only accepts field installer
             to generate a subform field installer.`});let t=e.hooks.slice(),r=B.TYPE_PREFIX+e.type,o="BLOCK_INVALID_PARENT",i=A.hooks.use(o,{accept:c.PARENT_TYPE}),l=A.hooks.use(o,{accept:B.PARENT_TYPE}),a=t.indexOf(i);return a>-1&&(t[a]=l),t=t.concat(lo,ao),x(u({},e),{type:r,group:B.GROUP_NAME,hooks:t})};var at=class{constructor(){this.i18n=w.create(),this.reactive=A({i18n:this.i18n}),at.MEMBERS.forEach(t=>this.reactive.install(t))}static create(...t){return new at(...t)}},L=at;N(L,"MEMBERS",[]),N(L,"Field",c);L.group=function(e=""){let t=L.MEMBERS.filter(r=>e?r.group===e:!r.group);return t.length?t:null};L.install=function(e={}){b.array(e)&&(e=[e]),e.forEach(t=>{let{type:r,group:o,providers:i,validators:l}=u({},t);h.nonblankString(r,'Form Member "Type"'),o&&h.nonblankString(o,'Form Member "group"'),i&&h.function(i,'Form Member "providers"'),l&&h.function(l,'Form Member "validators"'),L.MEMBERS.push(u({},t)),o===c.GROUP_NAME&&L.MEMBERS.push(B.generate(t))})};L.providers=function(e,t={}){var p;let{id:r,prop:o}=t,i=[];o="value";let l=e.get({id:r,prop:"type"}),a=(p=L.MEMBERS.find(d=>d.type===l))==null?void 0:p.providers;if(a)return a.call(e,{id:r,prop:o});if(Object.keys(e.members).forEach(d=>{if(d===r)return;let f=e.family.ancestor({id:d});!f||e.get({id:f.id,prop:"type"})!==Ae.type||!(e.naming("value").prop in e.members[d])||i.push({id:d,prop:o})}),!i.length)return null;let n=e.dependency.reliers({id:r,prop:o});if(!n)return i;let s=i.filter(d=>!n.some(f=>d.id===f.id&&d.prop===f.prop));return s.length?s:null};L.uninstall=function(e=""){!e||(L.MEMBERS=L.MEMBERS.filter(t=>t.type!==e))};L.validators=function(e,t={}){var s;let{id:r,prop:o}=t;o="value";let i=e.get({id:r,prop:"type"}),l=(s=L.MEMBERS.find(p=>p.type===i))==null?void 0:s.validators;if(l)return l.call(e,{id:r,prop:o});let a=e.schema.for({id:r,prop:o}).validation||[];b.array(a)&&(a=[a]);let n=a.find(p=>"dataType"in p);return n?e.validator.for(n.dataType,{except:"dataType"}):e.validator.for("*",{except:"dataType"}).find(p=>p.name==="presence")};L.install(Ae);L.install(Q);L.install(Ee);L.install(Yt);return zo;})();
//# sourceMappingURL=rcfm.model.iife.min.js-a58ebfa3.map
