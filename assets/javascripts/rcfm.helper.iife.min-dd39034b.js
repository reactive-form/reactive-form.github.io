/*!
 * rcfm 0.2.4 | Helper iife | https://jilinxiangyun.com
 * Copyright 2021 JLxiangyun | MIT license
 */
(()=>{var ee=Object.create;var B=Object.defineProperty,te=Object.defineProperties,re=Object.getOwnPropertyDescriptor,ne=Object.getOwnPropertyDescriptors,le=Object.getOwnPropertyNames,R=Object.getOwnPropertySymbols,ie=Object.getPrototypeOf,_=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var z=(e,t,n)=>t in e?B(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,s=(e,t)=>{for(var n in t||(t={}))_.call(t,n)&&z(e,n,t[n]);if(R)for(var n of R(t))oe.call(t,n)&&z(e,n,t[n]);return e},d=(e,t)=>te(e,ne(t)),ae=e=>B(e,"__esModule",{value:!0});var v=e=>{if(typeof require!="undefined")return require(e);throw new Error('Dynamic require of "'+e+'" is not supported')};var ue=(e,t,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of le(t))!_.call(e,r)&&r!=="default"&&B(e,r,{get:()=>t[r],enumerable:!(n=re(t,r))||n.enumerable});return e},y=e=>ue(ae(B(e!=null?ee(ie(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var U=(e,t,n)=>(z(e,typeof t!="symbol"?t+"":t,n),n);window.require||(window.require=e=>({rcfm:window.ReactiveForm})[e]);function w(e={},t={}){return e._installer||(e._installer=s({},t))}var k=class{constructor(){w(this,{installed:{}})}static create(...t){return new k(...t)}},h=k;U(h,"exceptions",{CONFLICTED_NAME:"UI_INSTALLER_CONFLICTED_NAME",NOT_FOUND:"UI_INSTALLER_TARGET_NOT_FOUND"});var E=y(v("rcfm"));h.prototype.install=function(e={}){let t=e.name,n=e.Component||e.component||e.render,r="force"in e?e.force:!1;E.Type.mustbe.nonblankString(t,"UI installer name"),E.Type.mustbe.boolean(r,"UI installer force option"),E.Type.mustbe.function(n,"UI installer component");let l=w(this).installed;!r&&t in l&&E.Exception.raise({type:h.exceptions.CONFLICTED_NAME,message:`Componnet/Section '${t}' is already existed.
             Please set 'force' to true if the existed
             component/section should be replaced.`}),l[t]={name:t,force:r,render:n}};var H=y(v("rcfm"));h.prototype.use=function(e=""){let t=w(this).installed;if(e in t)return t[e].render;H.Exception.raise({type:h.exceptions.NOT_FOUND,message:`Component/Section '${e}' is not installed.`})};var $=y(v("rcfm"));h.prototype.try=function(e=[]){$.Type.isnt.array(e)&&(e=[e]);let t=null;if(!e.length)return t=null;if(e.some(r=>{try{return t=this.use(r),!0}catch(l){return t=null,!1}}),t)return t;let n=`None of Component/Section '${JSON.stringify(e)}' is installed.`;$.Exception.raise({type:h.exceptions.NOT_FOUND,message:n})};var F=y(v("rcfm"));function g(e={},t={}){return e._debouncer||(e._debouncer=s({},t))}var P=class{constructor(t={}){let n=t.runner,r="interval"in t?t.interval:100;F.Type.mustbe.function(n,"Debouncer runner"),F.Type.mustbe.positiveInteger(r,"Debouncer interval"),g(this,{timer:null,interval:r,runner:n,runnerArgs:[]})}static create(...t){return new P(...t)}};P.prototype.abort=function(e=!0){let{timer:t,runner:n}=g(this);t!==null&&(clearTimeout(t),e&&n(...g(this).runnerArgs),g(this).runnerArgs=[],g(this).timer=null)};P.prototype.run=function(...e){let{runner:t,interval:n}=g(this);this.abort(!1),g(this).runnerArgs=e,g(this).timer=setTimeout(()=>{t(...g(this).runnerArgs),g(this).runnerArgs=[],g(this).timer=null},n)};var I=y(v("rcfm"));function se(e={}){return I.Context.mustbeContext(e.reactive),e.reactive}function ce(e={}){return I.Type.mustbe.object(e.member),I.Type.mustbe.nonblankString(e.member.id),e.member}function fe(e={}){return I.Type.mustbe.function(e.onChange),e.onChange}function a(e={},t="",n={}){let r="required"in n?n.required:!1,l="default"in n?n.default:void 0;if(r)I.Type.musntbe.blank(e[t],`Prop "${t}"`);else if(I.Type.is.blank(e[t]))return l;return t==="reactive"?se(e):t==="member"?ce(e):t==="onChange"?fe(e):I.Type.is.blank(e[t])?l:e[t]}function f(...e){return e.flat(1/0).filter(t=>t).join(" ")}var q=y(v("rcfm"));function me(e={}){let t=a(e,"type",{default:"info"}),n=a(e,"dismiss",{default:1/0});q.Type.mustbe.number(n);let r=f(`rcfm-alert-${t}`,e.className);return s({className:r,dismiss:n},q.Struct.object.exclude(e,["className","type","dismiss"]))}var de=(()=>{function e(t={}){let n=f("rcfm-alert-title",t.className);return d(s({},t),{className:n})}return{getProps:e}})(),be=(()=>{function e(t={}){let n=f("rcfm-alert-text",t.className);return d(s({},t),{className:n})}return{getProps:e}})(),ge={Title:de,Text:be,getProps:me},L=ge;var D=y(v("rcfm"));function he(e={}){let t=a(e,"type",{default:"button"}),n=a(e,"variant",{default:""}),r=a(e,"color",{default:"primary"}),l=a(e,"size",{default:""}),i="fluid"in e&&e.fluid!==!1,o="circle"in e&&e.circle!==!1,u="active"in e&&e.active!==!1,c="disabled"in e&&e.disabled!==!1,C=a(e,"onClick",{default:null}),p=pe(e),b=f(e.className,[n?`rcfm-btn-${n}-${r}`:`rcfm-btn-${r}`,l?`rcfm-btn-${l}`:"",i?"rcfm-btn-fluid":"",o?"rcfm-btn-circle":"",u?"rcfm-btn-active":"",p.position?`rcfm-btn-ico-${p.position}`:""]);return c&&(C=null),d(s({},D.Struct.object.exclude(e,["type","variant","color","size","fluid","circle","active","disabled","onClick","icon","topIcon","leftIcon","rightIcon"])),{type:t,className:b,icon:p,disabled:c,onClick:C})}function pe(e={}){return"icon"in e?{position:"middle",name:e.icon}:"topIcon"in e?{position:"top",name:e.topIcon}:"leftIcon"in e?{position:"left",name:e.leftIcon}:"rightIcon"in e?{position:"right",name:e.rightIcon}:{}}var ve=(()=>{function e(t={}){let n="vertical"in t?"vertical":"horizontal",r="fluid"in t&&t.fluid!==!1,l=f(t.className,[n==="horizontal"?"rcfm-btngroup-x":"rcfm-btngroup-y",r?"rcfm-btngroup-fluid":""]);return d(s({},D.Struct.object.exclude(t,["vertical","fluid"])),{className:l})}return{getProps:e}})(),ye={Group:ve,getProps:he},V=ye;var M=y(v("rcfm"));function Ce(e={}){let t=a(e,"name",{required:!0}),n=f(e.className,`rcfm-ico-${t}`);return d(s({},M.Struct.object.exclude(e,["name"])),{className:n})}var xe={getProps:Ce},J=xe;var j=y(v("rcfm"));function Ne(e={}){let t=a(e,"labels",{required:!0});j.Type.mustbe.array(t);let n=a(e,"activeIndex",{default:0});j.Type.mustbe.integer(n);let r=a(e,"onSwitch",{default:null});r&&j.Type.mustbe.function(r),n<0&&(n=0),n>t.length-1&&(n=t.length-1);let l=f(e.className,"rcfm-tabs"),i={header:"rcfm-tabs-header",title:"rcfm-tabs-title",label:"rcfm-tabs-label",pane:"rcfm-tabs-pane"};return d(s({},j.Struct.object.exclude(e,["className","labels","activeIndex","onSwitch"])),{className:l,classNames:i,labels:t,activeIndex:n,onSwitch:r})}function Pe(e,t,n){return`${e} ${t===n?e+"-active":""}`}var Ie={getProps:Ne,activateClass:Pe},W=Ie;var m=y(v("rcfm"));function G(e={}){return m.Struct.object.exclude(e,["className","invalid","size","name","placeholder","disabled","readonly","debounce","onChange"])}function S(e={},t={}){let n=t.mode||"loose",r=t.overrides||{},l="rootClass"in t?t.rootClass:"rcfm-fminput",i=a(e,"size"),o="invalid"in e&&e.invalid!==!1,u=f(e.className,["rcfm-fmtag",l,i?`rcfm-fm-${i}`:"",o?"rcfm-fm-invalid":""]),c=s({className:u},r);return n!=="loose"?c:s(s({},G(e)),c)}function O(e={},t={}){let n=t.mode||"loose",r=t.overrides||{},l=a(e,"name",{default:""}),i=a(e,"placeholder",{default:""}),o="disabled"in e&&e.disabled!==!1,u="readonly"in e&&e.readonly!==!1,c=a(e,"debounce",{default:null}),C=a(e,"onChange",{default:null}),p="rcfm-fmtag";(o||u)&&(C=null);let b=s({className:p,name:l,placeholder:i,disabled:o,readOnly:u,debounce:c,onChange:C},r);return n!=="loose"?b:s(s({},G(e)),b)}var we=(()=>{function e(t={}){let n="multiline"in t&&t.multiline!==!1,r=O(t,{mode:"loose",overrides:{type:"text",value:t.value||""}});delete r.multiline,n&&delete r.type;let l=S(t,{mode:"strict",rootClass:n?"rcfm-fmtextarea":"rcfm-fminput"});return{multiline:n,inputProps:r,wrapperProps:l}}return{getProps:e}})(),Te=(()=>{function e(t={}){let n=S(t,{mode:"strict",rootClass:"rcfm-fminput"}),r=O(t,{mode:"loose",overrides:{type:"number",value:(()=>isNaN(t.value)?"":typeof t.value=="number"?t.value:"")()}});return{wrapperProps:n,inputProps:r}}return{getProps:e}})(),Ee=(()=>{function e(t={}){let n=S(t,{mode:"loose",rootClass:"rcfm-fmradio"});delete n.value,delete n.options;let r=O(t,{mode:"strict",overrides:{type:"radio"}});r.readOnly&&(r.disabled=!0),delete r.debounce,delete r.placeholder;let l=a(t,"value",{default:void 0}),i=a(t,"options",{default:[]});return m.Type.mustbe.array(i),i.forEach(o=>{m.Type.mustbe.object(o,"Radio option"),m.Type.mustbe.string(o.label,"Radio Option label")}),{inputProps:r,wrapperProps:n,value:l,options:i}}return{getProps:e}})(),je=(()=>{function e(n={}){let r=S(n,{mode:"loose",rootClass:"rcfm-fmcheck"});delete r.value,delete r.options;let l=O(n,{mode:"strict",overrides:{type:"checkbox"}});l.readOnly&&(l.disabled=!0),delete l.debounce,delete l.placeholder;let i=a(n,"value",{default:[]});m.Type.mustbe.array(i);let o=a(n,"options",{default:[]});return m.Type.mustbe.array(o),o.forEach(u=>{m.Type.mustbe.object(u,"Checkbox option"),m.Type.mustbe.string(u.label,"Checkbox label")}),{wrapperProps:r,inputProps:l,value:i,options:o}}function t(n,r=[],l){let i=r.slice(),o=i.includes(l);return n.target.checked?!o&&i.push(l):o&&(i=i.filter(u=>u!==l)),i}return{getProps:e,getNewValue:t}})(),Se=(()=>{function e(n={}){let r=S(n,{mode:"strict",rootClass:"rcfm-fmselect"}),l=O(n,{mode:"loose"});l.readOnly&&(l.disabled=!0);let i=a(n,"value",{default:void 0}),o="includeBlank"in n&&n.includeBlank!==!1,u=a(n,"options",{default:[]});return m.Type.mustbe.array(u),u.forEach(c=>{m.Type.mustbe.object(c,"Select option"),m.Type.mustbe.string(c.label,"Select label")}),delete l.debounce,delete l.options,delete l.includeBlank,delete l.value,{inputProps:l,wrapperProps:r,includeBlank:o,options:u,value:i}}function t(n,r=[]){var l;return((l=r.find(i=>i.value===n))==null?void 0:l.label)||""}return{getProps:e,findLabel:t}})(),Oe=(()=>{function e(t={}){let n=S(t,{mode:"strict",rootClass:"rcfm-fmselect"}),r=O(t,{mode:"loose",overrides:{multiple:!0}});r.readOnly&&(r.disabled=!0);let l=a(t,"value",{default:[]});m.Type.mustbe.array(l);let i=a(t,"options",{default:[]});return m.Type.mustbe.array(i),i.forEach(o=>{m.Type.mustbe.object(o,"Select option"),m.Type.mustbe.string(o.label,"Select label")}),delete r.placeholder,delete r.debounce,delete r.options,delete r.value,{inputProps:r,wrapperProps:n,options:i,value:l}}return{getProps:e}})(),Be=(()=>{function e(i={}){let o=a(i,"size",{default:""}),u=f(i.className,["rcfm-fmtag","rcfm-fmfield",o?`rcfm-fmfield-${o}`:""]);return d(s({},m.Struct.object.exclude(i,["className","size","label","hint","error"])),{className:u})}function t(i={}){let o=a(i,"label",{default:""});if(!o)return{};let u=a(i,"size",{default:""});return{className:f(["rcfm-fmtag","rcfm-fmlabel",u?`rcfm-fmlabel-${u}`:""]),label:o}}function n(i={}){let o=a(i,"hint",{default:""});if(!o)return{};let u=a(i,"size",{default:""});return{className:f(["rcfm-fmtag","rcfm-fmhint",u?`rcfm-fmhint-${u}`:""]),hint:o}}function r(i={}){let o=(()=>"error"in i?(m.Type.is.array(i.error)?i.error:[i.error]).map(p=>p.message||p.name||p):"")();if(!o)return{};let u=a(i,"size",{default:""});return{className:f(["rcfm-fmtag","rcfm-fmerror",u?`rcfm-fmerror-${u}`:""]),error:o}}function l(i={}){return{wrapperProps:e(i),labelProps:t(i),hintProps:n(i),errorProps:r(i)}}return{getProps:l}})(),$e={Field:Be,TextInput:we,NumberInput:Te,Radios:Ee,Checkboxes:je,SingleSelect:Se,MultipleSelect:Oe},Y=$e;var T=y(v("rcfm"));var qe=(()=>{function e(t={}){let n=a(t,"value",{default:""}),r=a(t,"onChange");return d(s({},t),{value:n,onChange:r})}return{getProps:e}})(),ze=(()=>{function e(t={}){let n=a(t,"value"),r=a(t,"onChange");return d(s({},t),{value:n,onChange:r})}return{getProps:e}})(),ke=(()=>{T.I18n.global.define("en.dataTypeEditor.boolean.option.true","Yes"),T.I18n.global.define("en.dataTypeEditor.boolean.option.false","No"),T.I18n.global.define("zh.dataTypeEditor.boolean.option.true","\u662F"),T.I18n.global.define("zh.dataTypeEditor.boolean.option.false","\u5426");function e(t={}){let n=a(t,"value",{default:void 0}),r=a(t,"onChange"),l=[{value:!0,label:T.I18n.global.t("dataTypeEditor.boolean.option.true")},{value:!1,label:T.I18n.global.t("dataTypeEditor.boolean.option.false")}];return d(s({},t),{value:n,options:l,onChange:r})}return{getProps:e}})(),Fe=(()=>{function e(r){if([null,void 0,NaN].includes(r))return"";if(typeof r=="string")return r;try{return JSON.stringify(r)}catch(l){return String(r)}}function t(r){if(typeof r!="string")return r;if(r.match(/^\s*$/))return null;if(r!=="undefined"){if(r==="NaN")return NaN;if(r.match(/-\s*NaN/))return NaN;if(r==="Infinity")return 1/0;if(r.match(/-\s*Infinity/))return-1/0;try{return JSON.parse(r)}catch(l){return r}}}function n(r={}){let l=e(r.value),i=u=>r.onChange&&r.onChange(t(u)),o=f("rcfm-object-type-editor",r.className);return d(s({},r),{className:o,value:l,onChange:i})}return{getProps:n}})(),De={String:qe,Number:ze,Boolean:ke,Object:Fe},K=De;var x=y(v("rcfm"));function Ae(e,t=[],n={}){t=t.slice();let{index:r,action:l,name:i,rule:o}=n;return l==="delete"?t.splice(r,1):l==="append"?t.splice(r+1,0,{}):l==="update"&&("rule"in n&&(t[r].rule=o),"name"in n&&(t[r].name=i,t[r].rule=void 0)),t.map(u=>(u=e.validator.combineValidation(u),x.Struct.object.exclude(u,["valOf"])))}function Re(e={}){let t=a(e,"reactive",{required:!0}),n=a(e,"member",{required:!0}),r=a(e,"onChange",{required:!0}),l=a(e,"value",{default:[]});x.Type.mustbe.array(l),l.length||(l=[{}]),l=l.map(o=>t.validator.extractValidation(o));let i=a(e,"actions",{default:["append","update","delete"]});return x.Type.mustbe.array(i),{reactive:t,member:n,value:l,actions:i,onChange(o){r(l=Ae(t,l,o))}}}function _e(e={}){let t=a(e,"reactive",{required:!0}),n=a(e,"member",{required:!0});return(x.Form.validators(t,n)||[]).map(r=>({label:x.I18n.global.t(`validator.validators.${r.name}.label`),value:r.name}))}function Ue(e={}){var C;let t=a(e,"reactive",{required:!0}),n=a(e,"member",{required:!0}),r=a(e,"value",{required:!0});x.Type.mustbe.object(r);let{name:l,rule:i}=r,{ruleType:o}=t.validator.get(l)||{};if(!o)return;if(x.Type.is.string(o)&&o!=="*")return o;let c=(C=(t.schema.for(n).validation||[]).find(p=>"dataType"in p))==null?void 0:C.dataType;return x.Type.is.string(c)&&c!=="*"?c:"String"}var He={getProps:Re,getValidators:_e,getRuleType:Ue},Q=He;var N=y(v("rcfm"));N.I18n.global.define({en:{formConditionEditor:{elseBranch:{resultTitle:"Else"},whenBranch:{title:"When",resultTitle:"Then",delete:"Delete Branch",add:"New Branch",logic:{and:"And",or:"Or"}}}},zh:{formConditionEditor:{elseBranch:{resultTitle:"\u5426\u5219"},whenBranch:{title:"\u5F53",resultTitle:"\u5219",delete:"\u5220\u9664\u5206\u652F",add:"\u65B0\u589E\u5206\u652F",logic:{and:"\u4E14",or:"\u6216"}}}}});function Le(e={},t={},n){let r=s({},t.else),l=t.whens.slice(),{target:i,action:o,branchIndex:u,result:c}=e;return i==="else"?"result"in e&&(r.result=c):i==="when"&&(o==="delete"?l.splice(u,1):o==="append"?l.splice(u+1,0,{rules:[{logic:"",expression:{}}],result:A(n)}):o==="update"&&"result"in e&&(l[u].result=c)),{whens:l,else:r}}function Ve(e={},t={}){let n=s({},t.else),r=t.whens.slice(),{action:l,branchIndex:i,ruleIndex:o,logic:u,name:c,rule:C,value:p}=e,b=r.slice()[i].rules;return l==="delete"?(b.splice(o,1),o===0&&b.length&&(b[0].logic="")):l==="append"?(u=o===-1?"":"and",b.splice(o+1,0,{logic:u,expression:{}})):l==="update"&&("logic"in e&&(b[o].logic=u),"rule"in e&&(b[o].expression.rule=C),"name"in e&&(b[o].expression.name=c,b[o].expression.rule=void 0),"value"in e&&(b[o].expression.value=p,b[o].expression.name=void 0,b[o].expression.rule=void 0)),{whens:r,else:n}}function A(e){return N.Type.is.function(e)?e():e}function Me(e,t,n){let l=e.schema.constructor.Condition.extract(t);return N.Type.is.blank(l.else.result)&&(l.else={result:A(n)}),(N.Type.isnt.array(l.whens)||!l.whens.length)&&(l.whens=[{rules:[{logic:"",expression:{}}],result:A(n)}]),l.whens=l.whens.map(({rules:i,result:o})=>(i=i.length?i.map(({logic:u,expression:c})=>({logic:u,expression:e.validator.extractValidation(c)})):[{logic:"",expression:{}}],{rules:i,result:o})),l}function Je(e,t={}){return e.schema.constructor.Condition.combine({else:t.else,whens:t.whens.map(({rules:r,result:l})=>(r=r.map(({logic:i,expression:o})=>({logic:i,expression:e.validator.combineValidation(o)})),{rules:r,result:l}))})}function We(e={}){let t=a(e,"reactive",{required:!0}),n=a(e,"member",{required:!0}),r=a(e,"onChange",{required:!0}),l=a(e,"ResultComponent",{required:!0});N.Type.mustbe.function(l);let i=a(e,"defaultResult",{default:void 0}),o=a(e,"value",{default:[]}),u=Me(t,o,i);return{reactive:t,member:n,branches:u,ResultComponent:l,onChange(c={}){u=(c.target==="rule"?Ve:Le)(c,u,i),o=Je(t,u),r(o)}}}function Ge(){return[{value:"and",label:N.I18n.global.t("formConditionEditor.whenBranch.logic.and")},{value:"or",label:N.I18n.global.t("formConditionEditor.whenBranch.logic.or")}]}function X(e={}){return!e||!e.id||!e.prop?"":`${e.id}/${e.prop}`}function Ye(e=""){let[t,n]=e.split("/");return{id:t||"",prop:n||""}}function Ke(e={}){let t=a(e,"reactive",{required:!0}),n=a(e,"member",{required:!0});return(N.Form.providers(t,n)||[]).map(r=>({value:X(r),label:t.get({id:r.id,prop:"label"})}))}var Qe={getProps:We,getLogics:Ge,getProviders:Ke,splitProvider:Ye,joinProvider:X},Z=Qe;function Xe(){let e=h.create();return e.Debouncer=P,e.getProp=a,e.joinClass=f,e.Alert=L,e.Button=V,e.Icon=J,e.Tabs=W,e.Form=Y,e.DataTypeEditor=K,e.FormValidationEditor=Q,e.FormConditionEditor=Z,e}var Ze=Xe();typeof window!="undefined"&&window.ReactiveForm&&(window.ReactiveForm.UI=Ze);})();
//# sourceMappingURL=rcfm.helper.iife.min.js-9878c128.map
